(function(_){var filename = ((function(){var _documentCurrentScript = typeof document !== "undefined" ? document.currentScript : null;return typeof document === "undefined" ? require("url").pathToFileURL(__filename).href : _documentCurrentScript && _documentCurrentScript.src || new URL("index_27d9.js", document.baseURI).href})());for(var r in _){_[r].__farm_resource_pot__=filename;window['2567a5ec9705eb7ac2c984033e06189d'].__farm_module_system__.register(r,_[r])}})({"038863ec":function e(e,a,s,r){e._m(a),e.o(a,"Slider",()=>t);var l=s("15edfc35"),o=s("94a74ea6"),i=s("83a00617"),n=s("41124836"),c=e.w(s("a0fc9dfd")),d=e.w(s("3cad6ee2")),f=s("034c61a2"),t=c.forwardRef((e,a)=>{var s=e.className,r=i._(e,["className"]);return n.jsxs(d.Root,o._(l._({ref:a,className:f.cn("relative flex w-full touch-none select-none items-center",s)},r),{children:[n.jsx(d.Track,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:n.jsx(d.Range,{className:"absolute h-full bg-primary"})}),n.jsx(d.Thumb,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));});t.displayName=d.Root.displayName;},"099067a1":function e(e,r,i,n){e._m(r),e.o(r,"AppSidebar",()=>a);var l=i("41124836"),o=i("bb140a95"),t=i("549d1606"),d=i("c0837026"),c=[{title:"Home",url:"",icon:o.Home},{title:"Root",url:"/root",icon:o.Folder},{title:"All books",url:"/all",icon:o.BookCopy},{title:"Search",url:"/search",icon:o.Search}];function a(){return l.jsx(d.Sidebar,{children:l.jsx(d.SidebarContent,{children:l.jsxs(d.SidebarGroup,{children:[l.jsx(d.SidebarGroupLabel,{children:"shelf | Book"}),l.jsx(d.SidebarGroupContent,{children:l.jsx(d.SidebarMenu,{children:c.map(e=>l.jsx(d.SidebarMenuItem,{children:l.jsx(d.SidebarMenuButton,{asChild:!0,children:l.jsxs(t.Link,{to:e.url,children:[l.jsx(e.icon,{}),l.jsx("span",{children:e.title})]})})},e.title))})})]})})});}},"176f4e56":function e(e,r,t,i){e._m(r),e.o(r,"Input",()=>d);var o=t("15edfc35"),f=t("83a00617"),n=t("41124836"),s=e.w(t("a0fc9dfd")),a=t("034c61a2"),d=s.forwardRef((e,r)=>{var t=e.className,i=e.type,s=f._(e,["className","type"]);return n.jsx("input",o._({type:i,className:a.cn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r},s));});d.displayName="Input";},"19a898bf":function r(r,e,a,l){r._m(e),r.o(e,"ScrollArea",()=>f),r.o(e,"ScrollBar",()=>m);var o=a("15edfc35"),c=a("94a74ea6"),n=a("83a00617"),s=a("41124836"),i=r.w(a("a0fc9dfd")),t=r.w(a("5ca7eb89")),d=a("034c61a2"),f=i.forwardRef((r,e)=>{var a=r.className,l=r.children,i=n._(r,["className","children"]);return s.jsxs(t.Root,c._(o._({ref:e,className:d.cn("relative overflow-hidden",a)},i),{children:[s.jsx(t.Viewport,{className:"h-full w-full rounded-[inherit]",children:l}),s.jsx(m,{}),s.jsx(t.Corner,{})]}));});f.displayName=t.Root.displayName;var m=i.forwardRef((r,e)=>{var a=r.className,l=r.orientation,i=void 0===l?"vertical":l,f=n._(r,["className","orientation"]);return s.jsx(t.ScrollAreaScrollbar,c._(o._({ref:e,orientation:i,className:d.cn("flex touch-none select-none transition-colors","vertical"===i&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===i&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a)},f),{children:s.jsx(t.ScrollAreaThumb,{className:"relative flex-1 rounded-full bg-border"})}));});m.displayName=t.ScrollAreaScrollbar.displayName;},"2c6e69f1":function e(e,t,r,s){e._m(t);var o=r("41124836"),i=e.i(r("a0fc9dfd")),d=r("7ed15cd5"),n=r("549d1606"),x=e.i(r("16203e8b")),a=e.i(r("36209024")),j=e.i(r("e8628a33")),c=e.i(r("7e6887b5")),l=e.i(r("7b3edd37")),h=r("89807814"),u=r("2dd95686"),f=r("cdae4c23"),m=r("b36caee5"),R=document.querySelector("#root");if(!R)throw Error("No root element found");d.createRoot(R).render(o.jsx("div",{className:"w-screen h-screen overflow-hidden",children:o.jsx(e.f(i).StrictMode,{children:o.jsx(n.BrowserRouter,{children:o.jsxs(n.Routes,{children:[o.jsxs(n.Route,{path:"/",element:o.jsx(e.f(x),{}),children:[o.jsx(n.Route,{index:!0,element:o.jsx(e.f(a),{})}),o.jsx(n.Route,{path:"root/*",element:o.jsx(e.f(l),{})}),o.jsx(n.Route,{path:"all",element:o.jsx(e.f(c),{})}),o.jsx(n.Route,{path:"search",element:o.jsx(e.f(j),{})})]}),o.jsx(n.Route,{path:"/viewer/pdf",element:o.jsx(h.PDFViewerPage,{})}),o.jsx(n.Route,{path:"/viewer/epub",element:o.jsx(u.EPUBViewerPage,{})}),o.jsx(n.Route,{path:"/viewer/cbr",element:o.jsx(f.CBRViewerPage,{})}),o.jsx(n.Route,{path:"/viewer/cbz",element:o.jsx(m.CBZViewerPage,{})})]})})})}));},"2cf672ec":function t(t,e,a,n){t._m(e),t.o(e,"CBZViewer",()=>d);var o=a("493f9ad4");a("8a02f26b"),a("81b47ea5"),a("ec86718a"),a("2d08c2e5"),a("a3876e70"),a("b25dd2f8"),a("2554870f"),a("c98af605");var c=a("41124836"),r=a("a0fc9dfd"),i=a("64649060"),l=a("038863ec"),s=a("fca3c9cb"),h=a("bb43d73f"),u=a("caeda950");function d(t){var e=t.fileUrl,a=t.initialPage,n=void 0===a?1:a,d=o._(r.useState(null),2),g=d[0],m=d[1],p=o._(r.useState(n),2),f=p[0],w=p[1],x=o._(r.useState("ltr"),2),b=x[0],v=x[1],y=o._(r.useState("none"),2),j=y[0],k=y[1],M=o._(r.useState(.5),2),S=M[0],z=M[1],W=o._(r.useState([n]),2),H=W[0],_=W[1],C=r.useRef(null);r.useEffect(()=>{var t=localStorage.getItem("viewerOptions");if(t)try{var e=JSON.parse(t);v(e.direction),k(e.spread);}catch(t){console.warn("Failed to parse viewerOptions from localStorage");}},[]);var L=()=>{var t=1;switch(j){case"odd":t=f%2==1?2:3;break;case"even":t=f%2==1?3:2;}var e=Math.max(f-t,1);w(e),_([e]),s.sendProgress(null!=D?D:"",e.toString(),e/(null!=g?g:99999));},A=()=>{if(null!==g){var t=1;switch(j){case"odd":f%2==1&&(t=2);break;case"even":f%2==0&&(t=2);}var e=Math.min(f+t,g);w(e),_([e]),s.sendProgress(null!=D?D:"",e.toString(),e/(null!=g?g:99999));}},O=r.useMemo(()=>{switch(j){case"odd":return f%2==0?f-1:f;case"even":return 1!==f&&f%2==1?f-1:f;default:return f;}},[f,j]),P=r.useMemo(()=>{if(!g)return!1;switch(j){case"odd":return O!==g;case"even":return 1!==O&&O!==g;default:return!1;}},[O,j,g]),R=u.useWindowSize(),E=R.width,U=R.height,V=E/U,D=r.useMemo(()=>{try{return new URL(e,window.location.origin).searchParams.get("path");}catch(t){return console.warn("Invalid URL:",e),"";}},[e]);return h.sendAccess(null!=D?D:""),r.useEffect(()=>{(async()=>{try{var t,e=await fetch("/book/cbz/pages?path=".concat(D));if(!e.ok)throw Error("Failed to fetch page count");var a=await e.json(),o=null!==(t=a.pages)&&void 0!==t?t:1;m(o),(n<1||n>o)&&(w(1),_([1]));}catch(t){console.error("Error fetching CBZ page count:",t);}})();},[]),c.jsxs(i.ViewerLayout,{onOptionChanged:t=>{v(t.direction),k(t.spread);},onLeft:()=>{"ltr"===b?L():A();},onRight:()=>{"ltr"===b?A():L();},children:[c.jsx("div",{className:"relative w-full max-w-full h-screen overflow-hidden",children:c.jsxs("div",{style:{display:"flex",justifyContent:"center",transform:"scale(".concat(S,")"),transformOrigin:"top center"},children:["rtl"===b&&P&&c.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbz?path=".concat(D,"&page=").concat(Math.min(O+1,null!=g?g:1))},"l-/book/cbz?path=".concat(D,"&page=").concat(Math.min(O+1,null!=g?g:1))),c.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbz?path=".concat(D,"&page=").concat(O),ref:C,onLoad:()=>{var t=C.current.naturalWidth,e=C.current.naturalHeight,a=P?2*t:t;a/e>V?z(E/a):z(U/e);}},"m-/book/cbz?path=".concat(D,"&page=").concat(O)),"ltr"===b&&P&&c.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbz?path=".concat(D,"&page=").concat(Math.min(O+1,null!=g?g:1))},"r-/book/cbz?path=".concat(D,"&page=").concat(Math.min(O+1,null!=g?g:1))),c.jsxs("div",{style:{position:"absolute",width:0,height:0,overflow:"hidden"},children:[c.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbz?path=".concat(D,"&page=").concat(Math.max(O-1,1))}),c.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbz?path=".concat(D,"&page=").concat(Math.max(O-2,1))}),c.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbz?path=".concat(D,"&page=").concat(Math.min(O+1,null!=g?g:1))}),c.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbz?path=".concat(D,"&page=").concat(Math.min(O+2,null!=g?g:1))}),c.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbz?path=".concat(D,"&page=").concat(Math.min(O+3,null!=g?g:1))})]})]})}),c.jsx("div",{className:"absolute left-0 bottom-3 w-full",style:{opacity:.25},children:c.jsx(l.Slider,{value:H,min:1,max:null!=g?g:99999,step:1,onValueChange:t=>{_(t);},onValueCommit:t=>{t.length>0&&(w(t[0]),s.sendProgress(null!=D?D:"",t[0].toString(),t[0]/(null!=g?g:99999)));},dir:"rtl"===b?"rtl":"ltr",tabIndex:-1,onKeyDown:t=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)&&t.preventDefault();}})})]});}},"36209024":function a(a,e,s,l){a._m(e),a.o(e,"default",()=>n);var o=s("493f9ad4");s("b25dd2f8");var r=s("41124836"),c=s("a0fc9dfd"),i=s("e652ce53"),t=s("19a898bf");function n(){var a=o._(c.useState([]),2),e=a[0],s=a[1],l=o._(c.useState([]),2),n=l[0],d=l[1];return c.useEffect(()=>{(async function(){try{var a=await fetch("/api/all?sort=last_opened&order=desc&page=1");if(!a.ok)throw Error("Failed to fetch books");var e=await a.json();s(e.books);var l=await fetch("/api/all?sort=added_time&order=desc&page=1");if(!l.ok)throw Error("Failed to fetch books");var o=await l.json();d(o.books);}catch(a){}finally{}})();},[]),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsx("h1",{className:"text-2xl font-semibold",children:"Home Page"}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-xl font-medium",children:"Reading"}),r.jsxs(t.ScrollArea,{className:"w-[calc(100vw-19rem)] max-w-full",children:[r.jsx("div",{className:"inline-flex gap-4 ",children:e.map((a,e)=>r.jsx(i.BookCard,{book:a},e))}),r.jsx(t.ScrollBar,{orientation:"horizontal"})]})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-xl font-medium",children:"Arrivals"}),r.jsxs(t.ScrollArea,{className:"w-[calc(100vw-19rem)] max-w-full",children:[r.jsx("div",{className:"inline-flex gap-4 ",children:n.map((a,e)=>r.jsx(i.BookCard,{book:a},e))}),r.jsx(t.ScrollBar,{orientation:"horizontal"})]})]})]});}},"38df4482":function t(t,e,a,n){t._m(e),t.o(e,"CBRViewer",()=>d);var o=a("493f9ad4");a("8a02f26b"),a("81b47ea5"),a("ec86718a"),a("2d08c2e5"),a("a3876e70"),a("b25dd2f8"),a("2554870f"),a("c98af605");var r=a("41124836"),c=a("a0fc9dfd"),i=a("64649060"),l=a("038863ec"),s=a("fca3c9cb"),h=a("bb43d73f"),u=a("caeda950");function d(t){var e=t.fileUrl,a=t.initialPage,n=void 0===a?1:a,d=o._(c.useState(null),2),g=d[0],m=d[1],p=o._(c.useState(n),2),f=p[0],w=p[1],x=o._(c.useState("ltr"),2),b=x[0],v=x[1],y=o._(c.useState("none"),2),j=y[0],k=y[1],M=o._(c.useState(.5),2),S=M[0],W=M[1],H=o._(c.useState([n]),2),R=H[0],_=H[1],C=c.useRef(null);c.useEffect(()=>{var t=localStorage.getItem("viewerOptions");if(t)try{var e=JSON.parse(t);v(e.direction),k(e.spread);}catch(t){console.warn("Failed to parse viewerOptions from localStorage");}},[]);var L=()=>{var t=1;switch(j){case"odd":t=f%2==1?2:3;break;case"even":t=f%2==1?3:2;}var e=Math.max(f-t,1);w(e),_([e]),s.sendProgress(null!=I?I:"",e.toString(),e/(null!=g?g:99999));},A=()=>{if(null!==g){var t=1;switch(j){case"odd":f%2==1&&(t=2);break;case"even":f%2==0&&(t=2);}var e=Math.min(f+t,g);w(e),_([e]),s.sendProgress(null!=I?I:"",e.toString(),e/(null!=g?g:99999));}},O=c.useMemo(()=>{switch(j){case"odd":return f%2==0?f-1:f;case"even":return 1!==f&&f%2==1?f-1:f;default:return f;}},[f,j]),P=c.useMemo(()=>{if(!g)return!1;switch(j){case"odd":return O!==g;case"even":return 1!==O&&O!==g;default:return!1;}},[O,j,g]),E=u.useWindowSize(),U=E.width,V=E.height,D=U/V,I=c.useMemo(()=>{try{return new URL(e,window.location.origin).searchParams.get("path");}catch(t){return console.warn("Invalid URL:",e),"";}},[e]);return h.sendAccess(null!=I?I:""),c.useEffect(()=>{(async()=>{try{var t,e=await fetch("/book/cbr/pages?path=".concat(I));if(!e.ok)throw Error("Failed to fetch page count");var a=await e.json(),o=null!==(t=a.pages)&&void 0!==t?t:1;m(o),(n<1||n>o)&&(w(1),_([1]));}catch(t){console.error("Error fetching CBR page count:",t);}})();},[]),r.jsxs(i.ViewerLayout,{onOptionChanged:t=>{v(t.direction),k(t.spread);},onLeft:()=>{"ltr"===b?L():A();},onRight:()=>{"ltr"===b?A():L();},children:[r.jsx("div",{className:"relative w-full max-w-full h-screen overflow-hidden",children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",transform:"scale(".concat(S,")"),transformOrigin:"top center"},children:["rtl"===b&&P&&r.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbr?path=".concat(I,"&page=").concat(Math.min(O+1,null!=g?g:1))},"l-/book/cbr?path=".concat(I,"&page=").concat(Math.min(O+1,null!=g?g:1))),r.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbr?path=".concat(I,"&page=").concat(O),ref:C,onLoad:()=>{var t=C.current.naturalWidth,e=C.current.naturalHeight,a=P?2*t:t;a/e>D?W(U/a):W(V/e);}},"m-/book/cbr?path=".concat(I,"&page=").concat(O)),"ltr"===b&&P&&r.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbr?path=".concat(I,"&page=").concat(Math.min(O+1,null!=g?g:1))},"r-/book/cbr?path=".concat(I,"&page=").concat(Math.min(O+1,null!=g?g:1))),r.jsxs("div",{style:{position:"absolute",width:0,height:0,overflow:"hidden"},children:[r.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbr?path=".concat(I,"&page=").concat(Math.max(O-1,1))}),r.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbr?path=".concat(I,"&page=").concat(Math.max(O-2,1))}),r.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbr?path=".concat(I,"&page=").concat(Math.min(O+1,null!=g?g:1))}),r.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbr?path=".concat(I,"&page=").concat(Math.min(O+2,null!=g?g:1))}),r.jsx("img",{style:{width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},src:"/book/cbr?path=".concat(I,"&page=").concat(Math.min(O+3,null!=g?g:1))})]})]})}),r.jsx("div",{className:"absolute left-0 bottom-3 w-full",style:{opacity:.25},children:r.jsx(l.Slider,{value:R,min:1,max:null!=g?g:99999,step:1,onValueChange:t=>{_(t);},onValueCommit:t=>{t.length>0&&(w(t[0]),s.sendProgress(null!=I?I:"",t[0].toString(),t[0]/(null!=g?g:99999)));},dir:"rtl"===b?"rtl":"ltr",tabIndex:-1,onKeyDown:t=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)&&t.preventDefault();}})})]});}},"3a83d154":function a(a,e,r,s){a._m(e),a.o(e,"Card",()=>n),a.o(e,"CardDescription",()=>f),a.o(e,"CardContent",()=>o);var d=r("15edfc35"),c=r("83a00617"),l=r("41124836"),t=a.w(r("a0fc9dfd")),m=r("034c61a2"),n=t.forwardRef((a,e)=>{var r=a.className,s=c._(a,["className"]);return l.jsx("div",d._({ref:e,className:m.cn("rounded-lg border bg-card text-card-foreground shadow-sm",r)},s));});n.displayName="Card",t.forwardRef((a,e)=>{var r=a.className,s=c._(a,["className"]);return l.jsx("div",d._({ref:e,className:m.cn("flex flex-col space-y-1.5 p-6",r)},s));}).displayName="CardHeader",t.forwardRef((a,e)=>{var r=a.className,s=c._(a,["className"]);return l.jsx("div",d._({ref:e,className:m.cn("text-2xl font-semibold leading-none tracking-tight",r)},s));}).displayName="CardTitle";var f=t.forwardRef((a,e)=>{var r=a.className,s=c._(a,["className"]);return l.jsx("div",d._({ref:e,className:m.cn("text-sm text-muted-foreground",r)},s));});f.displayName="CardDescription";var o=t.forwardRef((a,e)=>{var r=a.className,s=c._(a,["className"]);return l.jsx("div",d._({ref:e,className:m.cn("p-6 pt-0",r)},s));});o.displayName="CardContent",t.forwardRef((a,e)=>{var r=a.className,s=c._(a,["className"]);return l.jsx("div",d._({ref:e,className:m.cn("flex items-center p-6 pt-0",r)},s));}).displayName="CardFooter";},"484004af":function e(e,t,r,n){e._m(t),e.o(t,"ViewerOptionSheet",()=>u);var a=r("15edfc35"),i=r("493f9ad4");r("625d46ca");var s=r("41124836"),l=r("a0fc9dfd"),d=r("176f4e56"),c=r("def0001e"),o=r("66529e7f"),h=r("7d352c04"),p=r("c21d65ea");function u(e){var t=e.onOptionChanged,r=i._(l.useState("ltr"),2),n=r[0],u=r[1],S=i._(l.useState("none"),2),f=S[0],v=S[1],x=i._(l.useState(16),2),g=x[0],j=x[1];l.useEffect(()=>{var e=localStorage.getItem("viewerOptions");if(e)try{var t=JSON.parse(e);u(t.direction),v(t.spread),j(t.fontSize);}catch(e){console.warn("Failed to parse viewerOptions from localStorage");}},[]);var m=e=>{var r=a._({direction:n,spread:f,fontSize:""===g?8:g},e);null==t||t(r),localStorage.setItem("viewerOptions",JSON.stringify(r));};return s.jsxs(p.SheetContent,{children:[s.jsx(p.SheetHeader,{children:s.jsx(p.SheetTitle,{children:"Options"})}),s.jsxs("div",{className:"grid flex-1 auto-rows-min gap-6 px-4 pt-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(c.Label,{htmlFor:"direction-switch",children:"Right to Left"}),s.jsx(o.Switch,{id:"direction-switch",checked:"rtl"===n,onCheckedChange:e=>{var t=e?"rtl":"ltr";u(t),m({direction:t});}})]}),s.jsxs("div",{className:"grid gap-3",children:[s.jsx(c.Label,{htmlFor:"spread-select",children:"Spread Mode (Not supported in ePUB)"}),s.jsxs(h.Select,{value:f,onValueChange:e=>{v(e),m({spread:e});},children:[s.jsx(h.SelectTrigger,{id:"spread-select",children:s.jsx(h.SelectValue,{})}),s.jsxs(h.SelectContent,{children:[s.jsx(h.SelectItem,{value:"none",children:"No Spreads"}),s.jsx(h.SelectItem,{value:"odd",children:"Odd Spreads"}),s.jsx(h.SelectItem,{value:"even",children:"Even Spreads"})]})]})]}),s.jsxs("div",{className:"grid gap-3",children:[s.jsx(c.Label,{htmlFor:"font-size",children:"Font Size (Only for ePUB)"}),s.jsx(d.Input,{id:"font-size",type:"number",min:8,max:48,value:g,onChange:e=>{if(""===e.target.value){j("");return;}var t=parseInt(e.target.value,10);isNaN(t)||j(t);},onBlur:()=>{"number"==typeof g&&m({fontSize:g});},onKeyDown:e=>{"Enter"===e.key&&e.currentTarget.blur();}})]})]})]});}},"52dcece7":function e(e,a,r,t){e._m(a),e.o(a,"PDFViewer",()=>g);var n=r("493f9ad4");r("8a02f26b"),r("81b47ea5"),r("ec86718a"),r("2d08c2e5"),r("a3876e70"),r("2554870f"),r("c98af605");var s=r("41124836"),l=r("a0fc9dfd"),o=r("e6588e25"),i=r("64649060"),c=r("caeda950"),u=r("038863ec"),d=r("fca3c9cb"),h=r("bb43d73f");function g(e){var a=e.fileUrl,r=e.initialPage,t=void 0===r?1:r,g=n._(l.useState(null),2),m=g[0],f=g[1],w=n._(l.useState(t),2),v=w[0],p=w[1],x=n._(l.useState("ltr"),2),b=x[0],j=x[1],P=n._(l.useState("none"),2),S=P[0],M=P[1],y=n._(l.useState(.5),2),N=y[0],k=y[1],L=n._(l.useState([t]),2),_=L[0],O=L[1];l.useEffect(()=>{var e=localStorage.getItem("viewerOptions");if(e)try{var a=JSON.parse(e);j(a.direction),M(a.spread);}catch(e){console.warn("Failed to parse viewerOptions from localStorage");}},[]);var A=()=>{var e=1;switch(S){case"odd":e=v%2==1?2:3;break;case"even":e=v%2==1?3:2;}var a=Math.max(v-e,1);p(a),O([a]),d.sendProgress(null!=F?F:"",a.toString(),a/(null!=m?m:99999));},D=()=>{if(null!==m){var e=1;switch(S){case"odd":v%2==1&&(e=2);break;case"even":v%2==0&&(e=2);}var a=Math.min(v+e,m);p(a),O([a]),d.sendProgress(null!=F?F:"",a.toString(),a/(null!=m?m:99999));}},V=c.useWindowSize(),C=V.width,R=V.height,U=C/R,I=l.useMemo(()=>{switch(S){case"odd":return v%2==0?v-1:v;case"even":return 1!==v&&v%2==1?v-1:v;default:return v;}},[v,S]),W=l.useMemo(()=>{if(!m)return!1;switch(S){case"odd":return I!==m;case"even":return 1!==I&&I!==m;default:return!1;}},[I,S,m]),F=l.useMemo(()=>{try{return new URL(a,window.location.origin).searchParams.get("path");}catch(e){return console.warn("Invalid URL:",a),"";}},[a]);return h.sendAccess(null!=F?F:""),s.jsxs(i.ViewerLayout,{onOptionChanged:e=>{j(e.direction),M(e.spread);},onLeft:()=>{"ltr"===b?A():D();},onRight:()=>{"ltr"===b?D():A();},children:[s.jsx("div",{className:"relative w-full max-w-full h-screen overflow-hidden",children:s.jsx(o.Document,{file:a,onLoadSuccess:e=>{var a=e.numPages;f(a),(t<1||t>a)&&(p(1),O([1]));},children:s.jsxs("div",{style:{display:"flex",justifyContent:"center",transform:"scale(".concat(N,")"),transformOrigin:"top center"},children:["rtl"===b&&W&&s.jsx(o.Page,{pageNumber:Math.min(I+1,null!=m?m:1),scale:3}),s.jsx(o.Page,{pageNumber:I,scale:3,onLoadSuccess:e=>{var a=e.getViewport({scale:3}),r=a.width,t=a.height,n=W?2*r:r;n/t>U?k(C/n):k(R/t);}}),"ltr"===b&&W&&s.jsx(o.Page,{pageNumber:Math.min(I+1,null!=m?m:1),scale:3}),s.jsxs("div",{style:{position:"absolute",width:0,height:0,overflow:"hidden"},children:[s.jsx(o.Page,{pageNumber:Math.max(I-1,1),scale:3}),s.jsx(o.Page,{pageNumber:Math.max(I-2,1),scale:3}),s.jsx(o.Page,{pageNumber:Math.min(I+1,null!=m?m:1),scale:3}),s.jsx(o.Page,{pageNumber:Math.min(I+2,null!=m?m:1),scale:3}),s.jsx(o.Page,{pageNumber:Math.min(I+3,null!=m?m:1),scale:3})]})]})})}),s.jsx("div",{className:"absolute left-0 bottom-3 w-full",style:{opacity:.25},children:s.jsx(u.Slider,{value:_,min:1,max:null!=m?m:99999,step:1,onValueChange:e=>{O(e);},onValueCommit:e=>{e.length>0&&(p(e[0]),d.sendProgress(null!=F?F:"",e[0].toString(),e[0]/(null!=m?m:99999)));},dir:"rtl"===b?"rtl":"ltr",tabIndex:-1,onKeyDown:e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)&&e.preventDefault();}})})]});}o.pdfjs.GlobalWorkerOptions.workerPort=new Worker("/pdf.worker.min.js");},"64649060":function e(e,n,r,t){e._m(n),e.o(n,"ViewerLayout",()=>o);var l=r("41124836"),u=r("a0fc9dfd"),c=r("bb140a95"),i=r("c21d65ea"),s=r("484004af");function o(e){var n=e.children,r=e.onOptionChanged,t=e.onLeft,o=e.onRight,a=u.useRef(null),d=u.useRef(null);return u.useEffect(()=>{var e=e=>{"ArrowLeft"===e.key?null==t||t():"ArrowRight"===e.key&&(null==o||o());};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e);};},[t,o]),l.jsxs("div",{className:"w-full h-screen relative",children:[l.jsxs(i.Sheet,{children:[l.jsx(i.SheetTrigger,{asChild:!0,children:l.jsx(c.Settings2,{className:"absolute top-4 right-4 opacity-50 z-50"})}),l.jsx(s.ViewerOptionSheet,{onOptionChanged:r})]}),l.jsx("div",{className:"pointer-events-none flex items-center justify-center w-full h-full",onTouchStart:e=>{a.current=e.changedTouches[0].clientX;},onTouchEnd:e=>{if(d.current=e.changedTouches[0].clientX,null!==a.current&&null!==d.current){var n=a.current-d.current;Math.abs(n)>50&&(n>0?null==t||t():null==o||o());}a.current=null,d.current=null;},children:l.jsx("div",{className:"pointer-events-auto",children:n})})]});}},"66529e7f":function e(e,a,s,r){e._m(a),e.o(a,"Switch",()=>f);var n=s("15edfc35"),t=s("94a74ea6"),i=s("83a00617"),o=s("41124836"),c=e.w(s("a0fc9dfd")),d=e.w(s("66bfe063")),l=s("034c61a2"),f=c.forwardRef((e,a)=>{var s=e.className,r=i._(e,["className"]);return o.jsx(d.Root,t._(n._({className:l.cn("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s)},r),{ref:a,children:o.jsx(d.Thumb,{className:l.cn("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));});f.displayName=d.Root.displayName;},"6f2e80d2":function o(o,t,e,a){o._m(t),o.o(t,"Tooltip",()=>m),o.o(t,"TooltipTrigger",()=>p),o.o(t,"TooltipContent",()=>c),o.o(t,"TooltipProvider",()=>l);var d=e("15edfc35"),i=e("83a00617"),r=e("41124836"),s=o.w(e("a0fc9dfd")),n=o.w(e("49ffad49")),f=e("034c61a2"),l=n.Provider,m=n.Root,p=n.Trigger,c=s.forwardRef((o,t)=>{var e=o.className,a=o.sideOffset,s=i._(o,["className","sideOffset"]);return r.jsx(n.Content,d._({ref:t,sideOffset:void 0===a?4:a,className:f.cn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e)},s));});c.displayName=n.Content.displayName;},"7b3edd37":function e(e,a,l,s){e._m(a),e.o(a,"default",()=>x);var t=l("493f9ad4");l("e57b3270"),l("850e6c49");var c=l("41124836"),n=l("a0fc9dfd"),d=l("7d352c04"),i=l("66529e7f"),r=l("def0001e"),o=l("ce4cd164"),h=l("549d1606"),u=[{label:"Title",value:"title"},{label:"Date Added",value:"added_time"},{label:"Last Opened",value:"last_opened"},{label:"Progress",value:"progress"}];function x(){var e=h.useLocation(),a=t._(n.useState(""),2),l=a[0],s=a[1],x=t._(n.useState("title"),2),f=x[0],p=x[1],m=t._(n.useState("asc"),2),v=m[0],g=m[1],j=t._(n.useState("/api/root"),2),S=j[0],b=j[1];return n.useEffect(()=>{var a=e.pathname;if(b("/api".concat(a)),"/root"===a){s("Root");return;}var l=a.split("/");s(decodeURIComponent(l[l.length-1]||l[l.length-2]));},[e.pathname]),c.jsxs("div",{className:"p-6 space-y-6 w-full",children:[c.jsxs("div",{className:"flex items-center gap-4 w-full",children:[c.jsx("h1",{className:"text-2xl font-semibold flex-shrink-0",children:l}),c.jsxs("div",{className:"flex items-center gap-6 ml-auto flex-shrink-0",children:[c.jsxs(d.Select,{value:f,onValueChange:e=>p(e),children:[c.jsx(d.SelectTrigger,{className:"w-[200px]",children:c.jsx(d.SelectValue,{placeholder:"Sort by"})}),c.jsx(d.SelectContent,{children:u.map(e=>c.jsx(d.SelectItem,{value:e.value,children:e.label},e.value))})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(i.Switch,{id:"order-switch",checked:"asc"===v,onCheckedChange:e=>g(e?"asc":"desc")}),c.jsx(r.Label,{className:"w-[80px]",children:"asc"===v?"Ascending":"Descending"})]})]})]}),c.jsx(o.InfiniteBookList,{apiEndpoint:S,sortKey:f,sortOrder:v},"".concat(S,"-").concat(f,"-").concat(v))]});}},"7d352c04":function e(e,a,t,r){e._m(a),e.o(a,"Select",()=>f),e.o(a,"SelectValue",()=>p),e.o(a,"SelectTrigger",()=>u),e.o(a,"SelectContent",()=>N),e.o(a,"SelectItem",()=>g);var s=t("15edfc35"),l=t("94a74ea6"),o=t("83a00617"),n=t("41124836"),d=e.w(t("a0fc9dfd")),i=e.w(t("728982f2")),c=t("bb140a95"),m=t("034c61a2"),f=i.Root,p=i.Value,u=d.forwardRef((e,a)=>{var t=e.className,r=e.children,d=o._(e,["className","children"]);return n.jsxs(i.Trigger,l._(s._({ref:a,className:m.cn("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t)},d),{children:[r,n.jsx(i.Icon,{asChild:!0,children:n.jsx(c.ChevronDown,{className:"h-4 w-4 opacity-50"})})]}));});u.displayName=i.Trigger.displayName;var h=d.forwardRef((e,a)=>{var t=e.className,r=o._(e,["className"]);return n.jsx(i.ScrollUpButton,l._(s._({ref:a,className:m.cn("flex cursor-default items-center justify-center py-1",t)},r),{children:n.jsx(c.ChevronUp,{className:"h-4 w-4"})}));});h.displayName=i.ScrollUpButton.displayName;var x=d.forwardRef((e,a)=>{var t=e.className,r=o._(e,["className"]);return n.jsx(i.ScrollDownButton,l._(s._({ref:a,className:m.cn("flex cursor-default items-center justify-center py-1",t)},r),{children:n.jsx(c.ChevronDown,{className:"h-4 w-4"})}));});x.displayName=i.ScrollDownButton.displayName;var N=d.forwardRef((e,a)=>{var t=e.className,r=e.children,d=e.position,c=void 0===d?"popper":d,f=o._(e,["className","children","position"]);return n.jsx(i.Portal,{children:n.jsxs(i.Content,l._(s._({ref:a,className:m.cn("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:c},f),{children:[n.jsx(h,{}),n.jsx(i.Viewport,{className:m.cn("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),n.jsx(x,{})]}))});});N.displayName=i.Content.displayName,d.forwardRef((e,a)=>{var t=e.className,r=o._(e,["className"]);return n.jsx(i.Label,s._({ref:a,className:m.cn("py-1.5 pl-8 pr-2 text-sm font-semibold",t)},r));}).displayName=i.Label.displayName;var g=d.forwardRef((e,a)=>{var t=e.className,r=e.children,d=o._(e,["className","children"]);return n.jsxs(i.Item,l._(s._({ref:a,className:m.cn("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t)},d),{children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(i.ItemIndicator,{children:n.jsx(c.Check,{className:"h-4 w-4"})})}),n.jsx(i.ItemText,{children:r})]}));});g.displayName=i.Item.displayName,d.forwardRef((e,a)=>{var t=e.className,r=o._(e,["className"]);return n.jsx(i.Separator,s._({ref:a,className:m.cn("-mx-1 my-1 h-px bg-muted",t)},r));}).displayName=i.Separator.displayName;},"7e6887b5":function e(e,l,s,a){e._m(l),e.o(l,"default",()=>h);var c=s("493f9ad4"),t=s("41124836"),d=s("a0fc9dfd"),i=s("7d352c04"),n=s("66529e7f"),r=s("def0001e"),o=s("ce4cd164"),x=[{label:"Title",value:"title"},{label:"Date Added",value:"added_time"},{label:"Last Opened",value:"last_opened"},{label:"Progress",value:"progress"}];function h(){var e=c._(d.useState("title"),2),l=e[0],s=e[1],a=c._(d.useState("asc"),2),h=a[0],u=a[1];return t.jsxs("div",{className:"p-6 space-y-6 w-full",children:[t.jsxs("div",{className:"flex items-center gap-4 w-full",children:[t.jsx("h1",{className:"text-2xl font-semibold flex-shrink-0",children:"All books"}),t.jsxs("div",{className:"flex items-center gap-6 ml-auto flex-shrink-0",children:[t.jsxs(i.Select,{value:l,onValueChange:e=>s(e),children:[t.jsx(i.SelectTrigger,{className:"w-[200px]",children:t.jsx(i.SelectValue,{placeholder:"Sort by"})}),t.jsx(i.SelectContent,{children:x.map(e=>t.jsx(i.SelectItem,{value:e.value,children:e.label},e.value))})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(n.Switch,{id:"order-switch",checked:"asc"===h,onCheckedChange:e=>u(e?"asc":"desc")}),t.jsx(r.Label,{className:"w-[80px]",children:"asc"===h?"Ascending":"Descending"})]})]})]}),t.jsx(o.InfiniteBookList,{apiEndpoint:"/api/all",sortKey:l,sortOrder:h})]});}},"b8de400f":function a(a,o,e,r){a._m(o),a.o(o,"Separator",()=>f);var i=e("15edfc35"),t=e("83a00617"),d=e("41124836"),n=a.w(e("a0fc9dfd")),c=a.w(e("11e4d6f2")),l=e("034c61a2"),f=n.forwardRef((a,o)=>{var e=a.className,r=a.orientation,n=void 0===r?"horizontal":r,f=a.decorative,s=t._(a,["className","orientation","decorative"]);return d.jsx(c.Root,i._({ref:o,decorative:void 0===f||f,orientation:n,className:l.cn("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",e)},s));});f.displayName=c.Root.displayName;},"c049024a":function a(a,e,l,r){a._m(e),a.o(e,"Progress",()=>i);var s=l("15edfc35"),c=l("94a74ea6"),o=l("83a00617"),d=l("41124836"),f=a.w(l("a0fc9dfd")),n=a.w(l("bb517cec")),t=l("034c61a2"),i=f.forwardRef((a,e)=>{var l=a.className,r=a.value,f=o._(a,["className","value"]);return d.jsx(n.Root,c._(s._({ref:e,className:t.cn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l)},f),{children:d.jsx(n.Indicator,{className:"h-full w-full flex-1 bg-primary transition-all bg-red-600",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})}));});i.displayName=n.Root.displayName;},"c0837026":function e(e,a,r,t){e._m(a),e.o(a,"Sidebar",()=>k),e.o(a,"SidebarContent",()=>C),e.o(a,"SidebarGroup",()=>R),e.o(a,"SidebarGroupContent",()=>T),e.o(a,"SidebarGroupLabel",()=>M),e.o(a,"SidebarMenu",()=>I),e.o(a,"SidebarMenuButton",()=>A),e.o(a,"SidebarMenuItem",()=>O),e.o(a,"SidebarProvider",()=>j),e.o(a,"SidebarTrigger",()=>z),e.o(a,"useSidebar",()=>y);var i=r("548cb060"),s=r("d5212104"),d=r("15edfc35"),n=r("94a74ea6"),o=r("83a00617"),l=r("493f9ad4"),c=r("41124836"),u=e.w(r("a0fc9dfd")),b=r("5ef1656a"),f=r("cbbf6f67"),p=r("bb140a95"),m=r("cede16c6"),v=r("e9eacb2f"),g=r("e56048ee"),h=r("176f4e56"),x=r("b8de400f"),N=r("c21d65ea"),w=r("9551a45c"),_=r("6f2e80d2"),S=u.createContext(null);function y(){var e=u.useContext(S);if(!e)throw Error("useSidebar must be used within a SidebarProvider.");return e;}var j=u.forwardRef((e,a)=>{var r=e.defaultOpen,t=e.open,i=e.onOpenChange,s=e.className,b=e.style,f=e.children,p=o._(e,["defaultOpen","open","onOpenChange","className","style","children"]),g=m.useIsMobile(),h=l._(u.useState(!1),2),x=h[0],N=h[1],w=l._(u.useState(void 0===r||r),2),y=w[0],j=w[1],k=null!=t?t:y,z=u.useCallback(e=>{var a="function"==typeof e?e(k):e;i?i(a):j(a),document.cookie="".concat("sidebar_state","=").concat(a,"; path=/; max-age=").concat(604800);},[i,k]),C=u.useCallback(()=>g?N(e=>!e):z(e=>!e),[g,z,N]);u.useEffect(()=>{var e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),C());};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e);},[C]);var R=k?"expanded":"collapsed",M=u.useMemo(()=>({state:R,open:k,setOpen:z,isMobile:g,openMobile:x,setOpenMobile:N,toggleSidebar:C}),[R,k,z,g,x,N,C]);return c.jsx(S.Provider,{value:M,children:c.jsx(_.TooltipProvider,{delayDuration:0,children:c.jsx("div",n._(d._({style:d._({"--sidebar-width":"16rem","--sidebar-width-icon":"3rem"},b),className:v.cn("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",s),ref:a},p),{children:f}))})});});j.displayName="SidebarProvider";var k=u.forwardRef((e,a)=>{var r=e.side,t=void 0===r?"left":r,i=e.variant,s=void 0===i?"sidebar":i,l=e.collapsible,u=void 0===l?"offcanvas":l,b=e.className,f=e.children,p=o._(e,["side","variant","collapsible","className","children"]),m=y(),g=m.isMobile,h=m.state,x=m.openMobile,w=m.setOpenMobile;return"none"===u?c.jsx("div",n._(d._({className:v.cn("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",b),ref:a},p),{children:f})):g?c.jsx(N.Sheet,n._(d._({open:x,onOpenChange:w},p),{children:c.jsxs(N.SheetContent,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:t,children:[c.jsxs(N.SheetHeader,{className:"sr-only",children:[c.jsx(N.SheetTitle,{children:"Sidebar"}),c.jsx(N.SheetDescription,{children:"Displays the mobile sidebar."})]}),c.jsx("div",{className:"flex h-full w-full flex-col",children:f})]})})):c.jsxs("div",{ref:a,className:"group peer hidden text-sidebar-foreground md:block","data-state":h,"data-collapsible":"collapsed"===h?u:"","data-variant":s,"data-side":t,children:[c.jsx("div",{className:v.cn("relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===s||"inset"===s?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),c.jsx("div",n._(d._({className:v.cn("fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex","left"===t?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===s||"inset"===s?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",b)},p),{children:c.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:f})}))]});});k.displayName="Sidebar";var z=u.forwardRef((e,a)=>{var r=e.className,t=e.onClick,i=o._(e,["className","onClick"]),s=y().toggleSidebar;return c.jsxs(g.Button,n._(d._({ref:a,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:v.cn("h-7 w-7",r),onClick:e=>{null==t||t(e),s();}},i),{children:[c.jsx(p.PanelLeft,{}),c.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]}));});z.displayName="SidebarTrigger",u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]),i=y().toggleSidebar;return c.jsx("button",d._({ref:a,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:i,title:"Toggle Sidebar",className:v.cn("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",r)},t));}).displayName="SidebarRail",u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("main",d._({ref:a,className:v.cn("relative flex w-full flex-1 flex-col bg-background","md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",r)},t));}).displayName="SidebarInset",u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx(h.Input,d._({ref:a,"data-sidebar":"input",className:v.cn("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",r)},t));}).displayName="SidebarInput",u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("div",d._({ref:a,"data-sidebar":"header",className:v.cn("flex flex-col gap-2 p-2",r)},t));}).displayName="SidebarHeader",u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("div",d._({ref:a,"data-sidebar":"footer",className:v.cn("flex flex-col gap-2 p-2",r)},t));}).displayName="SidebarFooter",u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx(x.Separator,d._({ref:a,"data-sidebar":"separator",className:v.cn("mx-2 w-auto bg-sidebar-border",r)},t));}).displayName="SidebarSeparator";var C=u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("div",d._({ref:a,"data-sidebar":"content",className:v.cn("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",r)},t));});C.displayName="SidebarContent";var R=u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("div",d._({ref:a,"data-sidebar":"group",className:v.cn("relative flex w-full min-w-0 flex-col p-2",r)},t));});R.displayName="SidebarGroup";var M=u.forwardRef((e,a)=>{var r=e.className,t=e.asChild,i=o._(e,["className","asChild"]),s=void 0!==t&&t?b.Slot:"div";return c.jsx(s,d._({ref:a,"data-sidebar":"group-label",className:v.cn("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",r)},i));});M.displayName="SidebarGroupLabel",u.forwardRef((e,a)=>{var r=e.className,t=e.asChild,i=o._(e,["className","asChild"]),s=void 0!==t&&t?b.Slot:"button";return c.jsx(s,d._({ref:a,"data-sidebar":"group-action",className:v.cn("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",r)},i));}).displayName="SidebarGroupAction";var T=u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("div",d._({ref:a,"data-sidebar":"group-content",className:v.cn("w-full text-sm",r)},t));});T.displayName="SidebarGroupContent";var I=u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("ul",d._({ref:a,"data-sidebar":"menu",className:v.cn("flex w-full min-w-0 flex-col gap-1",r)},t));});I.displayName="SidebarMenu";var O=u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("li",d._({ref:a,"data-sidebar":"menu-item",className:v.cn("group/menu-item relative",r)},t));});O.displayName="SidebarMenuItem";var G=f.cva("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),A=u.forwardRef((e,a)=>{var r=e.asChild,t=e.isActive,i=e.variant,s=e.size,n=void 0===s?"default":s,l=e.tooltip,u=e.className,f=o._(e,["asChild","isActive","variant","size","tooltip","className"]),p=void 0!==r&&r?b.Slot:"button",m=y(),g=m.isMobile,h=m.state,x=c.jsx(p,d._({ref:a,"data-sidebar":"menu-button","data-size":n,"data-active":void 0!==t&&t,className:v.cn(G({variant:void 0===i?"default":i,size:n}),u)},f));return l?("string"==typeof l&&(l={children:l}),c.jsxs(_.Tooltip,{children:[c.jsx(_.TooltipTrigger,{asChild:!0,children:x}),c.jsx(_.TooltipContent,d._({side:"right",align:"center",hidden:"collapsed"!==h||g},l))]})):x;});A.displayName="SidebarMenuButton",u.forwardRef((e,a)=>{var r=e.className,t=e.asChild,i=e.showOnHover,s=o._(e,["className","asChild","showOnHover"]),n=void 0!==t&&t?b.Slot:"button";return c.jsx(n,d._({ref:a,"data-sidebar":"menu-action",className:v.cn("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",void 0!==i&&i&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",r)},s));}).displayName="SidebarMenuAction",u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("div",d._({ref:a,"data-sidebar":"menu-badge",className:v.cn("pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r)},t));}).displayName="SidebarMenuBadge",u.forwardRef((e,a)=>{var r=e.className,t=e.showIcon,i=o._(e,["className","showIcon"]),s=u.useMemo(()=>"".concat(Math.floor(40*Math.random())+50,"%"),[]);return c.jsxs("div",n._(d._({ref:a,"data-sidebar":"menu-skeleton",className:v.cn("flex h-8 items-center gap-2 rounded-md px-2",r)},i),{children:[void 0!==t&&t&&c.jsx(w.Skeleton,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),c.jsx(w.Skeleton,{className:"h-4 max-w-[--skeleton-width] flex-1","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":s}})]}));}).displayName="SidebarMenuSkeleton",u.forwardRef((e,a)=>{var r=e.className,t=o._(e,["className"]);return c.jsx("ul",d._({ref:a,"data-sidebar":"menu-sub",className:v.cn("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",r)},t));}).displayName="SidebarMenuSub",u.forwardRef((e,a)=>{var r=i._({},s._(e));return c.jsx("li",d._({ref:a},r));}).displayName="SidebarMenuSubItem",u.forwardRef((e,a)=>{var r=e.asChild,t=e.size,i=void 0===t?"md":t,s=e.isActive,n=e.className,l=o._(e,["asChild","size","isActive","className"]),u=void 0!==r&&r?b.Slot:"a";return c.jsx(u,d._({ref:a,"data-sidebar":"menu-sub-button","data-size":i,"data-active":s,className:v.cn("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===i&&"text-xs","md"===i&&"text-sm","group-data-[collapsible=icon]:hidden",n)},l));}).displayName="SidebarMenuSubButton";},"c21d65ea":function e(e,a,t,s){e._m(a),e.o(a,"Sheet",()=>p),e.o(a,"SheetTrigger",()=>u),e.o(a,"SheetContent",()=>x),e.o(a,"SheetHeader",()=>b),e.o(a,"SheetTitle",()=>y),e.o(a,"SheetDescription",()=>v);var o=t("15edfc35"),r=t("94a74ea6"),i=t("83a00617"),d=t("41124836"),n=e.w(t("a0fc9dfd")),l=e.w(t("7f08bfea")),c=t("cbbf6f67"),m=t("bb140a95"),f=t("034c61a2"),p=l.Root,u=l.Trigger,N=l.Portal,g=n.forwardRef((e,a)=>{var t=e.className,s=i._(e,["className"]);return d.jsx(l.Overlay,r._(o._({className:f.cn("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t)},s),{ref:a}));});g.displayName=l.Overlay.displayName;var h=c.cva("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),x=n.forwardRef((e,a)=>{var t=e.side,s=e.className,n=e.children,c=i._(e,["side","className","children"]);return d.jsxs(N,{children:[d.jsx(g,{}),d.jsxs(l.Content,r._(o._({ref:a,className:f.cn(h({side:void 0===t?"right":t}),s)},c),{children:[n,d.jsxs(l.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[d.jsx(m.X,{className:"h-4 w-4"}),d.jsx("span",{className:"sr-only",children:"Close"})]})]}))]});});x.displayName=l.Content.displayName;var b=e=>{var a=e.className,t=i._(e,["className"]);return d.jsx("div",o._({className:f.cn("flex flex-col space-y-2 text-center sm:text-left",a)},t));};b.displayName="SheetHeader";var y=n.forwardRef((e,a)=>{var t=e.className,s=i._(e,["className"]);return d.jsx(l.Title,o._({ref:a,className:f.cn("text-lg font-semibold text-foreground",t)},s));});y.displayName=l.Title.displayName;var v=n.forwardRef((e,a)=>{var t=e.className,s=i._(e,["className"]);return d.jsx(l.Description,o._({ref:a,className:f.cn("text-sm text-muted-foreground",t)},s));});v.displayName=l.Description.displayName;},"ce4cd164":function e(e,a,t,o){e._m(a),e.o(a,"InfiniteBookList",()=>d);var r=t("493f9ad4");t("b25dd2f8"),t("2d08c2e5"),t("a3876e70");var c=t("41124836"),s=t("a0fc9dfd"),n=t("66f6ab94"),f=t("19a898bf"),i=t("e652ce53");function d(e){var a=e.apiEndpoint,t=e.sortKey,o=e.sortOrder,d=e.q,l=r._(s.useState([]),2),u=l[0],h=l[1],p=r._(s.useState(1),2),v=p[0],w=p[1],x=r._(s.useState(!0),2),m=x[0],b=x[1],k=r._(s.useState(!1),2),S=k[0],j=k[1],y=n.useInView(),_=y.ref,g=y.inView;return s.useEffect(()=>{h([]),w(1),b(!0);},[a,t,o,d]),s.useEffect(()=>{m&&!S&&(async()=>{j(!0);try{var e=await fetch("".concat(a,"?sort=").concat(t,"&order=").concat(o,"&page=").concat(v,"&q=").concat(null!=d?d:""));if(!e.ok)throw Error("Failed to fetch books");var r=await e.json();h(e=>[...e,...r.books]),b(r.hasMore),w(e=>e+1);}catch(e){console.error(e),b(!1);}finally{j(!1);}})();},[g,a,t,o,d]),c.jsx(f.ScrollArea,{className:"h-[89vh] pr-2",children:c.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.map(e=>c.jsx(i.BookCard,{book:e},e.path)),m&&c.jsx("div",{ref:_,className:"w-full text-center py-4 text-muted-foreground",children:S?"Loading...":"Show more"})]})});}},"e56048ee":function e(e,r,t,n){e._m(r),e.o(r,"Button",()=>v);var o=t("15edfc35"),i=t("83a00617"),a=t("41124836"),s=e.w(t("a0fc9dfd")),d=t("5ef1656a"),c=t("cbbf6f67"),u=t("034c61a2"),f=c.cva("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),v=s.forwardRef((e,r)=>{var t=e.className,n=e.variant,s=e.size,c=e.asChild,v=i._(e,["className","variant","size","asChild"]),g=void 0!==c&&c?d.Slot:"button";return a.jsx(g,o._({className:u.cn(f({variant:n,size:s,className:t})),ref:r},v));});v.displayName="Button";},"e652ce53":function e(e,t,o,c){e._m(t),e.o(t,"BookCard",()=>l);var n=o("41124836"),a=o("3a83d154"),r=o("c049024a"),s=o("bb140a95"),i=o("549d1606");function l(e){var t=e.book,o=e.index,c=function(e){var t,o,c=encodeURIComponent(e.path),n=encodeURIComponent(null!==(t=e.title)&&void 0!==t?t:""),a=encodeURIComponent(null!==(o=e.currentPosition)&&void 0!==o?o:"");switch(e.type){case"PDF":return"/viewer/pdf?title=".concat(n,"&path=").concat(c,"&position=").concat(a);case"EPUB":return"/viewer/epub?title=".concat(n,"&path=").concat(c,"&position=").concat(a);case"CBZ":return"/viewer/cbz?title=".concat(n,"&path=").concat(c,"&position=").concat(a);case"CBR":return"/viewer/cbr?title=".concat(n,"&path=").concat(c,"&position=").concat(a);case"Folder":return"/root".concat(e.path);default:return console.warn("Unknown book type:",e.type),"/";}}(t);return n.jsx(i.Link,{to:c,children:n.jsxs(a.Card,{className:"w-[190px] h-[300px] flex-shrink-0",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:"/cover".concat(t.cover),alt:t.title,className:"w-full h-[240px] object-cover rounded-t"}),"Folder"===t.type&&n.jsx(s.Folder,{className:"absolute bottom-2 left-1 text-white bg-black bg-opacity-30 rounded p-1",size:32}),n.jsx(r.Progress,{value:100*t.progress,className:"h-1 absolute bottom-0 left-0 right-0 rounded-none"})]}),n.jsx(a.CardContent,{className:"p-2.5 pt-2",children:n.jsx(a.CardDescription,{className:"line-clamp-2",children:t.title})})]},o)});}},"e8628a33":function e(e,a,l,s){e._m(a),e.o(a,"default",()=>x);var c=l("493f9ad4");l("bbcbf397");var t=l("41124836"),d=l("a0fc9dfd"),n=l("176f4e56"),r=l("7d352c04"),i=l("66529e7f"),o=l("def0001e"),u=l("ce4cd164"),h=[{label:"Title",value:"title"},{label:"Date Added",value:"added_time"},{label:"Last Opened",value:"last_opened"},{label:"Progress",value:"progress"}];function x(){var e=c._(d.useState("title"),2),a=e[0],l=e[1],s=c._(d.useState("asc"),2),x=s[0],m=s[1],p=c._(d.useState(""),2),f=p[0],v=p[1];return t.jsxs("div",{className:"p-6 space-y-6 w-full",children:[t.jsxs("div",{className:"flex items-center gap-4 w-full",children:[t.jsx(n.Input,{type:"search",placeholder:"Search books...",value:f,onChange:e=>v(e.target.value),className:"flex-grow max-w-[33rem]"}),t.jsxs("div",{className:"flex items-center gap-6 ml-auto flex-shrink-0",children:[t.jsxs(r.Select,{value:a,onValueChange:e=>l(e),children:[t.jsx(r.SelectTrigger,{className:"w-[200px]",children:t.jsx(r.SelectValue,{placeholder:"Sort by"})}),t.jsx(r.SelectContent,{children:h.map(e=>t.jsx(r.SelectItem,{value:e.value,children:e.label},e.value))})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(i.Switch,{id:"order-switch",checked:"asc"===x,onCheckedChange:e=>m(e?"asc":"desc")}),t.jsx(o.Label,{className:"w-[80px]",children:"asc"===x?"Ascending":"Descending"})]})]})]}),t.jsx(u.InfiniteBookList,{apiEndpoint:"/api/search",sortKey:a,sortOrder:x,q:encodeURIComponent(f.trim())})]});}},"eae27425":function e(e,r,o,t){e._m(r),e.o(r,"EPUBViewer",()=>g);var n=o("15edfc35"),a=o("94a74ea6"),i=o("493f9ad4");o("81b47ea5"),o("ec86718a"),o("2d08c2e5"),o("a3876e70"),o("2554870f"),o("c98af605");var l=o("41124836"),c=o("a0fc9dfd"),s=o("6d053041"),d=o("64649060"),u=o("038863ec"),v=o("bb43d73f"),f=o("fca3c9cb"),w=a._(n._({},s.ReactReaderStyle),{arrow:a._(n._({},s.ReactReaderStyle.arrow),{display:"none"}),arrowHover:a._(n._({},s.ReactReaderStyle.arrowHover),{display:"none"})});function g(e){var r=e.fileUrl,o=i._(c.useState("ltr"),2),t=o[0],n=o[1],a=i._(c.useState(16),2),g=a[0],h=a[1],p=i._(c.useState([0]),2),y=p[0],S=p[1],m=i._(c.useState(0),2),R=m[0],b=m[1],x=i._(c.useState(!1),2),k=x[0],_=x[1],L=c.useRef(void 0);c.useEffect(()=>{var e=localStorage.getItem("viewerOptions");if(e)try{var r=JSON.parse(e);n(r.direction),h(r.fontSize);}catch(e){console.warn("Failed to parse viewerOptions from localStorage");}},[]),c.useEffect(()=>{if(L.current){var e=""===g?"16px":"".concat(g,"px");L.current.themes.fontSize(e);}},[g]);var A=()=>{var e;null===(e=L.current)||void 0===e||e.prev();},E=()=>{var e;null===(e=L.current)||void 0===e||e.next();},j=c.useMemo(()=>{try{return new URL(r,window.location.origin).searchParams.get("path");}catch(e){return console.warn("Invalid URL:",r),"";}},[r]);return v.sendAccess(null!=j?j:""),c.useEffect(()=>{var e=e=>{("ArrowLeft"===e.key||"ArrowRight"===e.key)&&(e.stopPropagation(),e.preventDefault());};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0);},[]),l.jsxs(d.ViewerLayout,{onOptionChanged:e=>{n(e.direction),h(e.fontSize);},onLeft:()=>{"ltr"===t?A():E();},onRight:()=>{"ltr"===t?E():A();},children:[l.jsx("div",{tabIndex:-1,style:{width:"100vw",height:"100vh"},children:l.jsx(s.ReactReader,{url:r,location:R,locationChanged:e=>{var r;if(b(e),k&&(null===(r=L.current)||void 0===r?void 0:r.book.locations)){var o,t=null===(o=L.current)||void 0===o?void 0:o.book.locations.percentageFromCfi(e);S([t]),f.sendProgress(null!=j?j:"",e,t);}},getRendition:e=>{L.current=e;var r=""===g?"16px":"".concat(g,"px");e.themes.fontSize(r),e.book.ready.then(()=>(console.log("Book ready, generating locations..."),e.book.locations.generate(1024))).then(()=>{_(!0);}).catch(e=>{console.error("Error generating locations:",e);});},showToc:!1,readerStyles:w,isRTL:"rtl"===t})}),l.jsx("div",{className:"absolute left-0 bottom-3 w-full z-50",style:{opacity:.25},children:l.jsx(u.Slider,{value:y,min:0,max:1,step:.001,onValueChange:e=>{S(e);},onValueCommit:e=>{if(e.length>0){var r,o;k&&(null===(r=L.current)||void 0===r?void 0:r.book.locations)&&L.current.display(null===(o=L.current)||void 0===o?void 0:o.book.locations.cfiFromPercentage(e[0]));}},dir:"rtl"===t?"rtl":"ltr",tabIndex:-1,onKeyDown:e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)&&e.preventDefault();}})})]});}},});
//# sourceMappingURL=index_27d9.2361956f.js.map