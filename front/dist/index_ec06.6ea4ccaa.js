(function(_){var filename = ((function(){var _documentCurrentScript = typeof document !== "undefined" ? document.currentScript : null;return typeof document === "undefined" ? require("url").pathToFileURL(__filename).href : _documentCurrentScript && _documentCurrentScript.src || new URL("index_ec06.js", document.baseURI).href})());for(var r in _){_[r].__farm_resource_pot__=filename;window['2567a5ec9705eb7ac2c984033e06189d'].__farm_module_system__.register(r,_[r])}})({"0668a852":function t(t,i,s,e){t._m(i);var h=s("ef158879"),d=s("a043b48d"),a=t.i(s("fc84397d"));class l{constructor(t){this.settings=t,this.name=t.layout||"reflowable",this._spread="none"!==t.spread,this._minSpreadWidth=t.minSpreadWidth||800,this._evenSpreads=t.evenSpreads||!1,"scrolled"===t.flow||"scrolled-continuous"===t.flow||"scrolled-doc"===t.flow?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1};}flow(t){return void 0!==t&&("scrolled"===t||"scrolled-continuous"===t||"scrolled-doc"===t?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow;}spread(t,i){return t&&(this._spread="none"!==t,this.update({spread:this._spread})),i>=0&&(this._minSpreadWidth=i),this._spread;}calculate(t,i,s){var e,h,d,a,l=1,o=s||0,r=t,n=Math.floor(r/12);l=this._spread&&r>=this._minSpreadWidth?2:1,"reflowable"!==this.name||"paginated"!==this._flow||s>=0||(o=n%2==0?n:n-1),"pre-paginated"===this.name&&(o=0),l>1?d=(e=r/l-o)+o:(e=r,d=r),"pre-paginated"===this.name&&l>1&&(r=e),h=e*l+o,a=r,this.width=r,this.height=i,this.spreadWidth=h,this.pageWidth=d,this.delta=a,this.columnWidth=e,this.gap=o,this.divisor=l,this.update({width:r,height:i,spreadWidth:h,pageWidth:d,delta:a,columnWidth:e,gap:o,divisor:l});}format(t,i,s){return"pre-paginated"===this.name?t.fit(this.columnWidth,this.height,i):"paginated"===this._flow?t.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):s&&"horizontal"===s?t.size(null,this.height):t.size(this.width,null);}count(t,i){let s,e;return"pre-paginated"===this.name?(s=1,e=1):e="paginated"===this._flow?(s=Math.ceil(t/(i=i||this.delta)))*this.divisor:s=Math.ceil(t/(i=i||this.height)),{spreads:s,pages:e};}update(t){if(Object.keys(t).forEach(i=>{this.props[i]===t[i]&&delete t[i];}),Object.keys(t).length>0){let i=h.extend(this.props,t);this.emit(d.EVENTS.LAYOUT.UPDATED,i,t);}}}t.f(a)(l.prototype),i.default=l;},"0f707ffe":function m(m,p,t,x){m._m(p);var s={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},a=function(){var m,p,t,x,a={};for(m in s)if(s.hasOwnProperty(m)){for(p in s[m])if(s[m].hasOwnProperty(p)){if("string"==typeof(t=s[m][p]))a[t]=m+"/"+p;else for(x=0;x<t.length;x++)a[t[x]]=m+"/"+p;}}return a;}();p.default={lookup:function(m){return m&&a[m.split(".").pop().toLowerCase()]||"text/plain";}};},"19a8aec4":function i(i,e,t,s){i._m(e);var n=i.i(t("fc84397d")),a=t("ef158879"),h=i.i(t("7fa13d64")),o=i.i(t("f85cdffd")),r=i.i(t("f92b9fa9")),d=i.i(t("ab536744")),p=i.i(t("83acacd7")),l=i.i(t("aa06c467")),c=i.i(t("6256bf23")),g=i.i(t("1a424f9b")),v=i.i(t("77c3e88b")),u=i.i(t("2a020ec6")),f=i.i(t("7faf87b1")),m=i.i(t("d9d2ff27")),b=i.i(t("bf80adb5")),y=i.i(t("c48282c2")),w=i.i(t("3dc98cea")),k=t("a043b48d");let O="META-INF/container.xml",E={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class P{constructor(e,t){void 0===t&&"string"!=typeof e&&e instanceof Blob==!1&&e instanceof ArrayBuffer==!1&&(t=e,e=void 0),this.settings=a.extend(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),a.extend(this.settings,t),this.opening=new a.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new a.defer,spine:new a.defer,metadata:new a.defer,cover:new a.defer,navigation:new a.defer,pageList:new a.defer,resources:new a.defer,displayOptions:new a.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||i.f(m),this.spine=new(i.f(r)),this.locations=new(i.f(d))(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(i=>{var t=Error("Cannot load book at "+e);this.emit(k.EVENTS.BOOK.OPEN_FAILED,t);});}open(e,t){var s,n=t||this.determineType(e);return n===E.BINARY?(this.archived=!0,this.url=new(i.f(h))("/",""),s=this.openEpub(e)):n===E.BASE64?(this.archived=!0,this.url=new(i.f(h))("/",""),s=this.openEpub(e,n)):n===E.EPUB?(this.archived=!0,this.url=new(i.f(h))("/",""),s=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):n==E.OPF?(this.url=new(i.f(h))(e),s=this.openPackaging(this.url.Path.toString())):n==E.MANIFEST?(this.url=new(i.f(h))(e),s=this.openManifest(this.url.Path.toString())):(this.url=new(i.f(h))(e),s=this.openContainer(O).then(this.openPackaging.bind(this))),s;}openEpub(i,e){return this.unarchive(i,e||this.settings.encoding).then(()=>this.openContainer(O)).then(i=>this.openPackaging(i));}openContainer(e){return this.load(e).then(e=>(this.container=new(i.f(p))(e),this.resolve(this.container.packagePath)));}openPackaging(e){return this.path=new(i.f(o))(e),this.load(e).then(e=>(this.packaging=new(i.f(l))(e),this.unpack(this.packaging)));}openManifest(e){return this.path=new(i.f(o))(e),this.load(e).then(e=>(this.packaging=new(i.f(l)),this.packaging.load(e),this.unpack(this.packaging)));}load(i){var e=this.resolve(i);return this.archived?this.archive.request(e):this.request(e,null,this.settings.requestCredentials,this.settings.requestHeaders);}resolve(i,e){if(i){var t=i;return i.indexOf("://")>-1?i:(this.path&&(t=this.path.resolve(i)),!1!=e&&this.url&&(t=this.url.resolve(t)),t);}}canonical(i){return i?this.settings.canonical?this.settings.canonical(i):this.resolve(i,!0):"";}determineType(e){var t;return"base64"===this.settings.encoding?E.BASE64:"string"!=typeof e?E.BINARY:((t=new(i.f(h))(e).path().extension)&&(t=t.replace(/\?.*$/,"")),t)?"epub"===t?E.EPUB:"opf"===t?E.OPF:"json"===t?E.MANIFEST:void 0:E.DIRECTORY;}unpack(e){this.package=e,""===this.packaging.metadata.layout?this.load(this.url.resolve("META-INF/com.apple.ibooks.display-options.xml")).then(e=>{this.displayOptions=new(i.f(w))(e),this.loading.displayOptions.resolve(this.displayOptions);}).catch(e=>{this.displayOptions=new(i.f(w)),this.loading.displayOptions.resolve(this.displayOptions);}):(this.displayOptions=new(i.f(w)),this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new(i.f(g))(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation);}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&"none"!=this.settings.replacements?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this);});}).catch(i=>{console.error(i);}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this);});}loadNavigation(e){let t=e.navPath||e.ncxPath,s=e.toc;return s?new Promise((t,n)=>{this.navigation=new(i.f(c))(s),e.pageList&&(this.pageList=new(i.f(v))(e.pageList)),t(this.navigation);}):t?this.load(t,"xml").then(e=>(this.navigation=new(i.f(c))(e),this.pageList=new(i.f(v))(e),this.navigation)):new Promise((e,t)=>{this.navigation=new(i.f(c)),this.pageList=new(i.f(v)),e(this.navigation);});}section(i){return this.spine.get(i);}renderTo(e,t){return this.rendition=new(i.f(u))(this,t),this.rendition.attachTo(e),this.rendition;}setRequestCredentials(i){this.settings.requestCredentials=i;}setRequestHeaders(i){this.settings.requestHeaders=i;}unarchive(e,t){return this.archive=new(i.f(f)),this.archive.open(e,t);}store(e){let t=this.settings.replacements&&"none"!==this.settings.replacements,s=this.url,n=this.settings.requestMethod||i.f(m).bind(this);return this.storage=new(i.f(y))(e,n,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let e=(i,e)=>{e.output=this.resources.substitute(i,e.url);};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new(i.f(h))("/",""),this.spine.hooks.serialize.register(e);}),this.storage.on("online",()=>{this.url=s,this.spine.hooks.serialize.deregister(e);});}),this.storage;}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null);}replacements(){return this.spine.hooks.serialize.register((i,e)=>{e.output=this.resources.substitute(i,e.url);}),this.resources.replacements().then(()=>this.resources.replaceCss());}getRange(e){var t=new(i.f(b))(e),s=this.spine.get(t.spinePos),n=this.load.bind(this);return s?s.load(n).then(function(i){return t.toRange(s.document);}):new Promise((i,e)=>{e("CFI could not be found");});}key(i){var e=i||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${k.EPUBJS_VERSION}:${e}`;}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1;}}i.f(n)(P.prototype),e.default=P;},"1a424f9b":function s(s,t,e,i){s._m(t);var r=e("ce74a605"),n=e("ef158879"),h=s.i(e("7fa13d64")),l=s.i(e("0f707ffe")),a=s.i(e("f85cdffd")),c=s.i(e("789f8ab1"));t.default=class{constructor(s,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(s);}process(s){this.manifest=s,this.resources=Object.keys(s).map(function(t){return s[t];}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls();}split(){this.html=this.resources.filter(function(s){if("application/xhtml+xml"===s.type||"text/html"===s.type)return!0;}),this.assets=this.resources.filter(function(s){if("application/xhtml+xml"!==s.type&&"text/html"!==s.type)return!0;}),this.css=this.resources.filter(function(s){if("text/css"===s.type)return!0;});}splitUrls(){this.urls=this.assets.map((function(s){return s.href;}).bind(this)),this.cssUrls=this.css.map(function(s){return s.href;});}createUrl(t){var e=new(s.f(h))(t),i=s.f(l).lookup(e.filename);return this.settings.archive?this.settings.archive.createUrl(t,{base64:"base64"===this.settings.replacements}):"base64"===this.settings.replacements?this.settings.request(t,"blob").then(s=>n.blob2base64(s)).then(s=>n.createBase64Url(s,i)):this.settings.request(t,"blob").then(s=>n.createBlobUrl(s,i));}replacements(){return"none"===this.settings.replacements?new Promise((function(s){s(this.urls);}).bind(this)):Promise.all(this.urls.map(s=>{var t=this.settings.resolver(s);return this.createUrl(t).catch(s=>(console.error(s),null));})).then(s=>(this.replacementUrls=s.filter(s=>"string"==typeof s),s));}replaceCss(s,t){var e=[];return s=s||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach((function(i){var r=this.createCssFile(i,s,t).then((function(s){var t=this.urls.indexOf(i);t>-1&&(this.replacementUrls[t]=s);}).bind(this));e.push(r);}).bind(this)),Promise.all(e);}createCssFile(t){if(s.f(c).isAbsolute(t))return new Promise(function(s){s();});var e,i=this.settings.resolver(t);e=this.settings.archive?this.settings.archive.getText(i):this.settings.request(i,"text");var h=this.urls.map(t=>{var e=this.settings.resolver(t);return new(s.f(a))(i).relative(e);});return e?e.then(s=>(s=r.substitute(s,h,this.replacementUrls),"base64"===this.settings.replacements?n.createBase64Url(s,"text/css"):n.createBlobUrl(s,"text/css")),s=>new Promise(function(s){s();})):new Promise(function(s){s();});}relativeTo(t,e){return e=e||this.settings.resolver,this.urls.map((function(i){var r=e(i);return new(s.f(a))(t).relative(r);}).bind(this));}get(s){var t=this.urls.indexOf(s);return -1===t?void 0:this.replacementUrls.length?new Promise((function(s,e){s(this.replacementUrls[t]);}).bind(this)):this.createUrl(s);}substitute(s,t){var e;return e=t?this.relativeTo(t):this.urls,r.substitute(s,e,this.replacementUrls);}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0;}};},"2a020ec6":function t(t,i,e,s){t._m(i);var n=t.i(e("fc84397d")),a=e("ef158879"),o=t.i(e("f9cf22ea")),h=t.i(e("bf80adb5")),r=t.i(e("77c5c406")),d=t.i(e("0668a852")),g=t.i(e("6fa060c7"));e("8fb0147d");var l=t.i(e("66e307a0")),c=e("a043b48d"),p=t.i(e("3ee48e39")),u=t.i(e("5a6d0fc7")),m=t.i(e("61c5674e"));class E{constructor(i,e){this.settings=a.extend(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),a.extend(this.settings,e),"object"==typeof this.settings.manager&&(this.manager=this.settings.manager),this.book=i,this.hooks={},this.hooks.display=new(t.f(o))(this),this.hooks.serialize=new(t.f(o))(this),this.hooks.content=new(t.f(o))(this),this.hooks.unloaded=new(t.f(o))(this),this.hooks.layout=new(t.f(o))(this),this.hooks.render=new(t.f(o))(this),this.hooks.show=new(t.f(o))(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new(t.f(g))(this),this.annotations=new(t.f(l))(this),this.epubcfi=new(t.f(h)),this.q=new(t.f(r))(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new a.defer,this.started=this.starting.promise,this.q.enqueue(this.start);}setManager(t){this.manager=t;}requireManager(i){return"string"==typeof i&&"default"===i?t.f(u):"string"==typeof i&&"continuous"===i?t.f(m):i;}requireView(i){return"string"==typeof i&&"iframe"===i?t.f(p):i;}start(){switch(this.settings.layout||"pre-paginated"!==this.book.package.metadata.layout&&"true"!==this.book.displayOptions.fixedLayout||(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(c.EVENTS.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(c.EVENTS.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(c.EVENTS.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(c.EVENTS.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(c.EVENTS.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(c.EVENTS.RENDITION.STARTED),this.starting.resolve();}attachTo(t){return this.q.enqueue((function(){this.manager.render(t,{width:this.settings.width,height:this.settings.height}),this.emit(c.EVENTS.RENDITION.ATTACHED);}).bind(this));}display(t){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,t);}_display(t){if(this.book){this.epubcfi.isCfiString(t);var i,e=new a.defer,s=e.promise;return(this.displaying=e,this.book.locations.length()&&a.isFloat(t)&&(t=this.book.locations.cfiFromPercentage(parseFloat(t))),i=this.book.spine.get(t))?this.manager.display(i,t).then(()=>{e.resolve(i),this.displaying=void 0,this.emit(c.EVENTS.RENDITION.DISPLAYED,i),this.reportLocation();},t=>{this.emit(c.EVENTS.RENDITION.DISPLAY_ERROR,t);}):e.reject(Error("No Section Found")),s;}}afterDisplayed(t){t.on(c.EVENTS.VIEWS.MARK_CLICKED,(i,e)=>this.triggerMarkEvent(i,e,t.contents)),this.hooks.render.trigger(t,this).then(()=>{t.contents?this.hooks.content.trigger(t.contents,this).then(()=>{this.emit(c.EVENTS.RENDITION.RENDERED,t.section,t);}):this.emit(c.EVENTS.RENDITION.RENDERED,t.section,t);});}afterRemoved(t){this.hooks.unloaded.trigger(t,this).then(()=>{this.emit(c.EVENTS.RENDITION.REMOVED,t.section,t);});}onResized(t,i){this.emit(c.EVENTS.RENDITION.RESIZED,{width:t.width,height:t.height},i),this.location&&this.location.start&&this.display(i||this.location.start.cfi);}onOrientationChange(t){this.emit(c.EVENTS.RENDITION.ORIENTATION_CHANGE,t);}moveTo(t){this.manager.moveTo(t);}resize(t,i,e){t&&(this.settings.width=t),i&&(this.settings.height=i),this.manager.resize(t,i,e);}clear(){this.manager.clear();}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this));}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this));}determineLayoutProperties(t){var i=this.settings.layout||t.layout||"reflowable",e=this.settings.spread||t.spread||"auto",s=this.settings.orientation||t.orientation||"auto",n=this.settings.flow||t.flow||"auto",a=t.viewport||"",o=this.settings.minSpreadWidth||t.minSpreadWidth||800,h=this.settings.direction||t.direction||"ltr";return(0===this.settings.width||this.settings.width>0)&&(0===this.settings.height||this.settings.height),{layout:i,spread:e,orientation:s,flow:n,viewport:a,minSpreadWidth:o,direction:h};}flow(t){var i=t;("scrolled"===t||"scrolled-doc"===t||"scrolled-continuous"===t)&&(i="scrolled"),("auto"===t||"paginated"===t)&&(i="paginated"),this.settings.flow=t,this._layout&&this._layout.flow(i),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(i),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi));}layout(i){return i&&(this._layout=new(t.f(d))(i),this._layout.spread(i.spread,this.settings.minSpreadWidth),this._layout.on(c.EVENTS.LAYOUT.UPDATED,(t,i)=>{this.emit(c.EVENTS.RENDITION.LAYOUT,t,i);})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout;}spread(t,i){this.settings.spread=t,i&&(this.settings.minSpreadWidth=i),this._layout&&this._layout.spread(t,i),this.manager&&this.manager.isRendered()&&this.manager.updateLayout();}direction(t){this.settings.direction=t||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi));}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var t=this.manager.currentLocation();if(t&&t.then&&"function"==typeof t.then)t.then((function(t){let i=this.located(t);i&&i.start&&i.end&&(this.location=i,this.emit(c.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(c.EVENTS.RENDITION.RELOCATED,this.location));}).bind(this));else if(t){let i=this.located(t);if(!i||!i.start||!i.end)return;this.location=i,this.emit(c.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(c.EVENTS.RENDITION.RELOCATED,this.location);}}).bind(this));}).bind(this));}currentLocation(){var t=this.manager.currentLocation();if(t&&t.then&&"function"==typeof t.then)t.then((function(t){return this.located(t);}).bind(this));else if(t)return this.located(t);}located(t){if(!t.length)return{};let i=t[0],e=t[t.length-1],s={start:{index:i.index,href:i.href,cfi:i.mapping.start,displayed:{page:i.pages[0]||1,total:i.totalPages}},end:{index:e.index,href:e.href,cfi:e.mapping.end,displayed:{page:e.pages[e.pages.length-1]||1,total:e.totalPages}}},n=this.book.locations.locationFromCfi(i.mapping.start),a=this.book.locations.locationFromCfi(e.mapping.end);null!=n&&(s.start.location=n,s.start.percentage=this.book.locations.percentageFromLocation(n)),null!=a&&(s.end.location=a,s.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(i.mapping.start),h=this.book.pageList.pageFromCfi(e.mapping.end);return -1!=o&&(s.start.page=o),-1!=h&&(s.end.page=h),e.index===this.book.spine.last().index&&s.end.displayed.page>=s.end.displayed.total&&(s.atEnd=!0),i.index===this.book.spine.first().index&&1===s.start.displayed.page&&(s.atStart=!0),s;}destroy(){this.manager&&this.manager.destroy(),this.book=void 0;}passEvents(t){c.DOM_EVENTS.forEach(i=>{t.on(i,i=>this.triggerViewEvent(i,t));}),t.on(c.EVENTS.CONTENTS.SELECTED,i=>this.triggerSelectedEvent(i,t));}triggerViewEvent(t,i){this.emit(t.type,t,i);}triggerSelectedEvent(t,i){this.emit(c.EVENTS.RENDITION.SELECTED,t,i);}triggerMarkEvent(t,i,e){this.emit(c.EVENTS.RENDITION.MARK_CLICKED,t,i,e);}getRange(i,e){var s=new(t.f(h))(i),n=this.manager.visible().filter(function(t){if(s.spinePos===t.index)return!0;});if(n.length)return n[0].contents.range(s,e);}adjustImages(t){if("pre-paginated"===this._layout.name)return new Promise(function(t){t();});let i=t.window.getComputedStyle(t.content,null),e=(t.content.offsetHeight-(parseFloat(i.paddingTop)+parseFloat(i.paddingBottom)))*.95,s=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight);return t.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":e+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":e+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(t,i){setTimeout(function(){t();},1);});}getContents(){return this.manager?this.manager.getContents():[];}views(){return(this.manager?this.manager.views:void 0)||[];}handleLinks(t){t&&t.on(c.EVENTS.CONTENTS.LINK_CLICKED,t=>{let i=this.book.path.relative(t);this.display(i);});}injectStylesheet(t,i){let e=t.createElement("link");e.setAttribute("type","text/css"),e.setAttribute("rel","stylesheet"),e.setAttribute("href",this.settings.stylesheet),t.getElementsByTagName("head")[0].appendChild(e);}injectScript(t,i){let e=t.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",this.settings.script),e.textContent=" ",t.getElementsByTagName("head")[0].appendChild(e);}injectIdentifier(t,i){let e=this.book.packaging.metadata.identifier,s=t.createElement("meta");s.setAttribute("name","dc.relation.ispartof"),e&&s.setAttribute("content",e),t.getElementsByTagName("head")[0].appendChild(s);}}t.f(n)(E.prototype),i.default=E;},"32761f19":function t(t,s,i,e){t._m(s);var o=i("ef158879"),h=i("a043b48d"),n=t.i(i("fc84397d"));let r=function(t){return Math.pow(t,3);};class l{constructor(t,s){this.settings=o.extend({duration:80,minVelocity:.2,minDistance:10,easing:r},s||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(t);}setup(t){this.manager=t,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=2*this.settings.duration,this.isVertical="vertical"===this.manager.settings.axis,this.manager.isPaginated&&!this.isVertical&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners());}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch);}disableScroll(){this.element.style.overflow="hidden";}enableScroll(){this.element.style.overflow="";}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(h.EVENTS.MANAGERS.ADDED,this._afterDisplayed);}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(h.EVENTS.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0;}afterDisplayed(t){let s=t.contents;["touchstart","touchmove","touchend"].forEach(t=>{s.on(t,t=>this.triggerViewEvent(t,s));});}triggerViewEvent(t,s){this.emit(t.type,t,s);}onScroll(t){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop;}onResize(t){this.resizeCanceler=!0;}onTouchStart(t){let{screenX:s,screenY:i}=t.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=s,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=s,this.endTouchY=i,this.endTime=this.now();}onTouchMove(t){let{screenX:s,screenY:i}=t.touches[0],e=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&e<10&&(this.element.scrollLeft-=s-this.endTouchX),this.endTouchX=s,this.endTouchY=i,this.endTime=this.now();}onTouchEnd(t){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let s=this.wasSwiped();0!==s?this.snap(s):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0;}wasSwiped(){let t=this.layout.pageWidth*this.layout.divisor,s=this.endTouchX-this.startTouchX,i=Math.abs(s),e=s/(this.endTime-this.startTime),o=this.settings.minVelocity;return i<=this.settings.minDistance||i>=t?0:e>o?-1:e<-o?1:void 0;}needsSnap(){return this.scrollLeft%(this.layout.pageWidth*this.layout.divisor)!=0;}snap(t=0){let s=this.scrollLeft,i=this.layout.pageWidth*this.layout.divisor,e=Math.round(s/i)*i;return t&&(e+=t*i),this.smoothScrollTo(e);}smoothScrollTo(t){let s=new o.defer,i=this.scrollLeft,e=this.now(),h=this.settings.duration,n=this.settings.easing;return this.snapping=!0,(function o(){let r=Math.min(1,(this.now()-e)/h);if(n(r),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,s.resolve();return;}r<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(i+(t-i)*r,0)):(this.scrollTo(t,0),this.snapping=!1,s.resolve());}).call(this),s.promise;}scrollTo(t=0,s=0){this.fullsize?window.scroll(t,s):(this.scroller.scrollLeft=t,this.scroller.scrollTop=s);}now(){return"now"in window.performance?performance.now():new Date().getTime();}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0);}}t.f(n)(l.prototype),s.default=l;},"3dc98cea":function t(t,e,i,o){t._m(e);var a=i("ef158879");e.default=class{constructor(t){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",t&&this.parse(t);}parse(t){if(!t)return this;let e=a.qs(t,"display_options");return e&&a.qsa(e,"option").forEach(t=>{let e="";switch(t.childNodes.length&&(e=t.childNodes[0].nodeValue),t.attributes.name.value){case"interactive":this.interactive=e;break;case"fixed-layout":this.fixedLayout=e;break;case"open-to-spread":this.openToSpread=e;break;case"orientation-lock":this.orientationLock=e;}}),this;}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0;}};},"3ee48e39":function t(t,e,i,s){t._m(e);var n=t.i(i("fc84397d")),h=i("ef158879"),r=t.i(i("bf80adb5")),l=t.i(i("8fb0147d")),o=i("a043b48d"),a=i("b37b81ab");class d{constructor(e,i){this.settings=h.extend({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},i||{}),this.id="epubjs-view-"+h.uuid(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new(t.f(r)),this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={};}container(t){var e=document.createElement("div");return e.classList.add("epub-view"),e.style.height="0px",e.style.width="0px",e.style.overflow="hidden",e.style.position="relative",e.style.display="block",t&&"horizontal"==t?e.style.flex="none":e.style.flex="initial",e;}create(){return this.iframe||(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=h.bounds(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write")),this.iframe;}render(t,e){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(t)),this.sectionRender.then((function(t){return this.load(t);}).bind(this)).then((function(){let t,e=this.contents.writingMode();return t="scrolled"===this.settings.flow?0===e.indexOf("vertical")?"horizontal":"vertical":0===e.indexOf("vertical")?"vertical":"horizontal",0===e.indexOf("vertical")&&"paginated"===this.settings.flow&&(this.layout.delta=this.layout.height),this.setAxis(t),this.emit(o.EVENTS.VIEWS.AXIS,t),this.setWritingMode(e),this.emit(o.EVENTS.VIEWS.WRITING_MODE,e),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((t,e)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),t();});}).bind(this),(function(t){return this.emit(o.EVENTS.VIEWS.LOAD_ERROR,t),new Promise((e,i)=>{i(t);});}).bind(this)).then((function(){this.emit(o.EVENTS.VIEWS.RENDERED,this.section);}).bind(this));}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0;}size(t,e){var i=t||this.settings.width,s=e||this.settings.height;"pre-paginated"===this.layout.name?this.lock("both",i,s):"horizontal"===this.settings.axis?this.lock("height",i,s):this.lock("width",i,s),this.settings.width=i,this.settings.height=s;}lock(t,e,i){var s,n=h.borders(this.element);s=this.iframe?h.borders(this.iframe):{width:0,height:0},"width"==t&&h.isNumber(e)&&(this.lockedWidth=e-n.width-s.width),"height"==t&&h.isNumber(i)&&(this.lockedHeight=i-n.height-s.height),"both"===t&&h.isNumber(e)&&h.isNumber(i)&&(this.lockedWidth=e-n.width-s.width,this.lockedHeight=i-n.height-s.height),this.displayed&&this.iframe&&this.expand();}expand(t){var e,i=this.lockedWidth,s=this.lockedHeight;this.iframe&&!this._expanding&&(this._expanding=!0,"pre-paginated"===this.layout.name?(i=this.layout.columnWidth,s=this.layout.height):"horizontal"===this.settings.axis?((i=this.contents.textWidth())%this.layout.pageWidth>0&&(i=Math.ceil(i/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(e=i/this.layout.pageWidth,this.layout.divisor>1&&"reflowable"===this.layout.name&&e%2>0&&(i+=this.layout.pageWidth))):"vertical"===this.settings.axis&&(s=this.contents.textHeight(),"paginated"===this.settings.flow&&s%this.layout.height>0&&(s=Math.ceil(s/this.layout.height)*this.layout.height)),(this._needsReframe||i!=this._width||s!=this._height)&&this.reframe(i,s),this._expanding=!1);}reframe(t,e){var i;h.isNumber(t)&&(this.element.style.width=t+"px",this.iframe.style.width=t+"px",this._width=t),h.isNumber(e)&&(this.element.style.height=e+"px",this.iframe.style.height=e+"px",this._height=e);let s=this.prevBounds?t-this.prevBounds.width:t,n=this.prevBounds?e-this.prevBounds.height:e;i={width:t,height:e,widthDelta:s,heightDelta:n},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let t;for(let e in this.marks)this.marks.hasOwnProperty(e)&&(t=this.marks[e],this.placeMark(t.element,t.range));}),this.onResize(this,i),this.emit(o.EVENTS.VIEWS.RESIZED,i),this.prevBounds=i,this.elementBounds=h.bounds(this.element);}load(t){var e=new h.defer,i=e.promise;if(!this.iframe)return e.reject(Error("No Iframe Available")),i;if(this.iframe.onload=(function(t){this.onLoad(t,e);}).bind(this),"blobUrl"===this.settings.method)this.blobUrl=h.createBlobUrl(t,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if("srcdoc"===this.settings.method)this.iframe.srcdoc=t,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return e.reject(Error("No Document Available")),i;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var s=this;MSApp.execUnsafeLocalFunction(function(){s.iframe.contentDocument.write(t);});}else this.iframe.contentDocument.write(t);this.iframe.contentDocument.close();}return i;}onLoad(e,i){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new(t.f(l))(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var s=this.document.querySelector("link[rel='canonical']");s?s.setAttribute("href",this.section.canonical):((s=this.document.createElement("link")).setAttribute("rel","canonical"),s.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(s)),this.contents.on(o.EVENTS.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents));}),this.contents.on(o.EVENTS.CONTENTS.RESIZE,t=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents));}),i.resolve(this.contents);}setLayout(t){this.layout=t,this.contents&&(this.layout.format(this.contents),this.expand());}setAxis(t){this.settings.axis=t,"horizontal"==t?this.element.style.flex="none":this.element.style.flex="initial",this.size();}setWritingMode(t){this.writingMode=t;}addListeners(){}removeListeners(t){}display(t){var e=new h.defer;return this.displayed?e.resolve(this):this.render(t).then((function(){this.emit(o.EVENTS.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,e.resolve(this);}).bind(this),function(t){e.reject(t,this);}),e.promise;}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(o.EVENTS.VIEWS.SHOWN,this);}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(o.EVENTS.VIEWS.HIDDEN,this);}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft};}width(){return this._width;}height(){return this._height;}position(){return this.element.getBoundingClientRect();}locationOf(t){this.iframe.getBoundingClientRect();var e=this.contents.locationOf(t,this.settings.ignoreClass);return{left:e.left,top:e.top};}onDisplayed(t){}onResize(t,e){}bounds(t){return(t||!this.elementBounds)&&(this.elementBounds=h.bounds(this.element)),this.elementBounds;}highlight(t,e={},i,s="epubjs-hl",n={}){if(!this.contents)return;let h=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},n),r=this.contents.range(t),l=()=>{this.emit(o.EVENTS.VIEWS.MARK_CLICKED,t,e);};e.epubcfi=t,this.pane||(this.pane=new a.Pane(this.iframe,this.element));let d=new a.Highlight(r,s,e,h),m=this.pane.addMark(d);return this.highlights[t]={mark:m,element:m.element,listeners:[l,i]},m.element.setAttribute("ref",s),m.element.addEventListener("click",l),m.element.addEventListener("touchstart",l),i&&(m.element.addEventListener("click",i),m.element.addEventListener("touchstart",i)),m;}underline(t,e={},i,s="epubjs-ul",n={}){if(!this.contents)return;let h=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},n),r=this.contents.range(t),l=()=>{this.emit(o.EVENTS.VIEWS.MARK_CLICKED,t,e);};e.epubcfi=t,this.pane||(this.pane=new a.Pane(this.iframe,this.element));let d=new a.Underline(r,s,e,h),m=this.pane.addMark(d);return this.underlines[t]={mark:m,element:m.element,listeners:[l,i]},m.element.setAttribute("ref",s),m.element.addEventListener("click",l),m.element.addEventListener("touchstart",l),i&&(m.element.addEventListener("click",i),m.element.addEventListener("touchstart",i)),m;}mark(t,e={},i){if(!this.contents)return;if(t in this.marks)return this.marks[t];let s=this.contents.range(t);if(!s)return;let n=s.commonAncestorContainer,h=1===n.nodeType?n:n.parentNode,r=i=>{this.emit(o.EVENTS.VIEWS.MARK_CLICKED,t,e);};s.collapsed&&1===n.nodeType?(s=new Range).selectNodeContents(n):s.collapsed&&(s=new Range).selectNodeContents(h);let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=t,e&&Object.keys(e).forEach(t=>{l.dataset[t]=e[t];}),i&&(l.addEventListener("click",i),l.addEventListener("touchstart",i)),l.addEventListener("click",r),l.addEventListener("touchstart",r),this.placeMark(l,s),this.element.appendChild(l),this.marks[t]={element:l,range:s,listeners:[r,i]},h;}placeMark(t,e){let i,s,n;if("pre-paginated"===this.layout.name||"horizontal"!==this.settings.axis){let t=e.getBoundingClientRect();i=t.top,s=t.right;}else{let t,r=e.getClientRects();for(var h=0;h!=r.length;h++)t=r[h],(!n||t.left<n)&&(s=Math.ceil((n=t.left)/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,i=t.top);}t.style.top=`${i}px`,t.style.left=`${s}px`;}unhighlight(t){let e;t in this.highlights&&(e=this.highlights[t],this.pane.removeMark(e.mark),e.listeners.forEach(t=>{t&&(e.element.removeEventListener("click",t),e.element.removeEventListener("touchstart",t));}),delete this.highlights[t]);}ununderline(t){let e;t in this.underlines&&(e=this.underlines[t],this.pane.removeMark(e.mark),e.listeners.forEach(t=>{t&&(e.element.removeEventListener("click",t),e.element.removeEventListener("touchstart",t));}),delete this.underlines[t]);}unmark(t){let e;t in this.marks&&(e=this.marks[t],this.element.removeChild(e.element),e.listeners.forEach(t=>{t&&(e.element.removeEventListener("click",t),e.element.removeEventListener("touchstart",t));}),delete this.marks[t]);}destroy(){for(let t in this.highlights)this.unhighlight(t);for(let t in this.underlines)this.ununderline(t);for(let t in this.marks)this.unmark(t);this.blobUrl&&h.revokeBlobUrl(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null);}}t.f(n)(d.prototype),e.default=d;},"5a6d0fc7":function t(t,i,s,e){t._m(i);var h=t.i(s("fc84397d")),o=s("ef158879"),n=t.i(s("dc23aa53")),l=t.i(s("671ca8e7")),a=t.i(s("77c5c406")),r=t.i(s("6f914524")),d=t.i(s("7c6257d0")),c=s("a043b48d");class g{constructor(i){this.name="default",this.optsSettings=i.settings,this.View=i.view,this.request=i.request,this.renditionQueue=i.queue,this.q=new(t.f(a))(this),this.settings=o.extend(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),o.extend(this.settings,i.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1;}render(i,s){let e=i.tagName;void 0===this.settings.fullsize&&e&&("body"==e.toLowerCase()||"html"==e.toLowerCase())&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=s,this.settings.rtlScrollType=t.f(n)(),this.stage=new(t.f(r))({width:s.width,height:s.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(i),this.container=this.stage.getContainer(),this.views=new(t.f(d))(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0;}addEventListeners(){var t;window.addEventListener("unload",(function(t){this.destroy();}).bind(this)),t=this.settings.fullsize?window:this.container,this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll);}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0;}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1;}onOrientationChange(t){let{orientation:i}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(c.EVENTS.MANAGERS.ORIENTATION_CHANGE,i);}).bind(this),500);}onResized(t){this.resize();}resize(t,i,s){let e=this.stage.size(t,i);if(this.winBounds=o.windowBounds(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return;}this._stageSize&&this._stageSize.width===e.width&&this._stageSize.height===e.height||(this._stageSize=e,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(c.EVENTS.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},s));}createView(t,i){return new this.View(t,o.extend(this.viewSettings,{forceRight:i}));}handleNextPrePaginated(t,i,s){let e;if("pre-paginated"===this.layout.name&&this.layout.divisor>1){if(t||0===i.index)return;if((e=i.next())&&!e.properties.includes("page-spread-left"))return s.call(this,e);}}display(t,i){var s=new o.defer,e=s.promise;(i===t.href||o.isNumber(i))&&(i=void 0);var h=this.views.find(t);if(h&&t&&"pre-paginated"!==this.layout.name){let t=h.offset();if("ltr"===this.settings.direction)this.scrollTo(t.left,t.top,!0);else{let i=h.width();this.scrollTo(t.left+i,t.top,!0);}if(i){let t=h.locationOf(i),s=h.width();this.moveTo(t,s);}return s.resolve(),e;}this.clear();let n=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&t.properties.includes("page-spread-right")&&(n=!0),this.add(t,n).then((function(t){if(i){let s=t.locationOf(i),e=t.width();this.moveTo(s,e);}}).bind(this),t=>{s.reject(t);}).then((function(){return this.handleNextPrePaginated(n,t,this.add);}).bind(this)).then((function(){this.views.show(),s.resolve();}).bind(this)),e;}afterDisplayed(t){this.emit(c.EVENTS.MANAGERS.ADDED,t);}afterResized(t){this.emit(c.EVENTS.MANAGERS.RESIZE,t.section);}moveTo(t,i){var s=0,e=0;this.isPaginated?((s=Math.floor(t.left/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollWidth&&(s=this.container.scrollWidth-this.layout.delta),(e=Math.floor(t.top/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollHeight&&(e=this.container.scrollHeight-this.layout.delta)):e=t.top,"rtl"===this.settings.direction&&(s+=this.layout.delta,s-=i),this.scrollTo(s,e,!0);}add(t,i){var s=this.createView(t,i);return this.views.append(s),s.onDisplayed=this.afterDisplayed.bind(this),s.onResize=this.afterResized.bind(this),s.on(c.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t);}),s.on(c.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t);}),s.display(this.request);}append(t,i){var s=this.createView(t,i);return this.views.append(s),s.onDisplayed=this.afterDisplayed.bind(this),s.onResize=this.afterResized.bind(this),s.on(c.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t);}),s.on(c.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t);}),s.display(this.request);}prepend(t,i){var s=this.createView(t,i);return s.on(c.EVENTS.VIEWS.RESIZED,t=>{this.counter(t);}),this.views.prepend(s),s.onDisplayed=this.afterDisplayed.bind(this),s.onResize=this.afterResized.bind(this),s.on(c.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t);}),s.on(c.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t);}),s.display(this.request);}counter(t){"vertical"===this.settings.axis?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0);}next(){var t;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis&&(!i||"ltr"===i)?(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft+this.container.offsetWidth+this.layout.delta<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()):this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===i?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft>0?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next():this.container.scrollLeft+-1*this.layout.delta>-1*this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):t=this.views.last().section.next()):t=this.views.last().section.next(),t)){this.clear(),this.updateLayout();let i=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&t.properties.includes("page-spread-right")&&(i=!0),this.append(t,i).then((function(){return this.handleNextPrePaginated(i,t,this.append);}).bind(this),t=>t).then((function(){this.isPaginated||"horizontal"!==this.settings.axis||"rtl"!==this.settings.direction||"default"!==this.settings.rtlScrollType||this.scrollTo(this.container.scrollWidth,0,!0),this.views.show();}).bind(this));}}prev(){var t;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis&&(!i||"ltr"===i)?(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft>0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()):this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===i?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft+this.container.offsetWidth<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev():this.container.scrollLeft<0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):t=this.views.first().section.prev()):t=this.views.first().section.prev(),t)){this.clear(),this.updateLayout();let i=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&"object"!=typeof t.prev()&&(i=!0),this.prepend(t,i).then((function(){var i;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&(i=t.prev()))return this.prepend(i);}).bind(this),t=>t).then((function(){this.isPaginated&&"horizontal"===this.settings.axis&&("rtl"===this.settings.direction?"default"===this.settings.rtlScrollType?this.scrollTo(0,0,!0):this.scrollTo(-1*this.container.scrollWidth+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show();}).bind(this));}}current(){var t=this.visible();return t.length?t[t.length-1]:null;}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear());}currentLocation(){return this.updateLayout(),this.isPaginated&&"horizontal"===this.settings.axis?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location;}scrolledLocation(){let t=this.visible(),i=this.container.getBoundingClientRect(),s=i.height<window.innerHeight?i.height:window.innerHeight,e=i.width<window.innerWidth?i.width:window.innerWidth,h="vertical"===this.settings.axis;this.settings.direction;let o=0;return this.settings.fullsize&&(o=h?window.scrollY:window.scrollX),t.map(t=>{let n,l,a,r,{index:d,href:c}=t.section,g=t.position(),u=t.width(),p=t.height();h?(l=(n=o+i.top-g.top+0)+s-0,r=this.layout.count(p,s).pages,a=s):(l=(n=o+i.left-g.left+0)+e-0,r=this.layout.count(u,e).pages,a=e);let w=Math.ceil(n/a),f=[],v=Math.ceil(l/a);if("rtl"===this.settings.direction&&!h){let t=w;w=r-v,v=r-t;}f=[];for(var y=w;y<=v;y++){let t=y+1;f.push(t);}return{index:d,href:c,pages:f,totalPages:r,mapping:this.mapping.page(t.contents,t.section.cfiBase,n,l)};});}paginatedLocation(){let t=this.visible(),i=this.container.getBoundingClientRect(),s=0,e=0;return this.settings.fullsize&&(s=window.scrollX),t.map(t=>{let h,o,n,l,{index:a,href:r}=t.section,d=t.position(),c=t.width();"rtl"===this.settings.direction?(l=Math.min(Math.abs((h=i.right-s)-d.left),this.layout.width)-e,o=(n=d.width-(d.right-h)-e)-l):(h=i.left+s,l=Math.min(d.right-h,this.layout.width)-e,n=(o=h-d.left+e)+l),e+=l;let g=this.mapping.page(t.contents,t.section.cfiBase,o,n),u=this.layout.count(c).pages,p=Math.floor(o/this.layout.pageWidth),w=[],f=Math.floor(n/this.layout.pageWidth);if(p<0&&(p=0,f+=1),"rtl"===this.settings.direction){let t=p;p=u-f,f=u-t;}for(var v=p+1;v<=f;v++){let t=v;w.push(t);}return{index:a,href:r,pages:w,totalPages:u,mapping:g};});}isVisible(t,i,s,e){var h=t.position(),o=e||this.bounds();return"horizontal"===this.settings.axis&&h.right>o.left-i&&h.left<o.right+s||"vertical"===this.settings.axis&&h.bottom>o.top-i&&h.top<o.bottom+s;}visible(){for(var t,i=this.bounds(),s=this.views.displayed(),e=s.length,h=[],o=0;o<e;o++)t=s[o],!0===this.isVisible(t,0,0,i)&&h.push(t);return h;}scrollBy(t,i,s){let e="rtl"===this.settings.direction?-1:1;s&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(t*e,i*e):(t&&(this.container.scrollLeft+=t*e),i&&(this.container.scrollTop+=i)),this.scrolled=!0;}scrollTo(t,i,s){s&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(t,i):(this.container.scrollLeft=t,this.container.scrollTop=i),this.scrolled=!0;}onScroll(){let t,i;this.settings.fullsize?(t=window.scrollY,i=window.scrollX):(t=this.container.scrollTop,i=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=i,this.ignore?this.ignore=!1:(this.emit(c.EVENTS.MANAGERS.SCROLL,{top:t,left:i}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(c.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft});}).bind(this),20));}bounds(){return this.stage.bounds();}applyLayout(t){this.layout=t,this.updateLayout(),this.views&&this.views.length>0&&"pre-paginated"===this.layout.name&&this.display(this.views.first().section);}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout));}setLayout(i){this.viewSettings.layout=i,this.mapping=new(t.f(l))(i.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(i);});}updateWritingMode(t){this.writingMode=t;}updateAxis(i,s){(s||i!==this.settings.axis)&&(this.settings.axis=i,this.stage&&this.stage.axis(i),this.viewSettings.axis=i,this.mapping&&(this.mapping=new(t.f(l))(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&("vertical"===i?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)));}updateFlow(t,i="auto"){let s="paginated"===t||"auto"===t;this.isPaginated=s,"scrolled-doc"===t||"scrolled-continuous"===t||"scrolled"===t?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=t,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=s?"hidden":i,this.stage&&this.stage.overflow(this.overflow),this.updateLayout();}getContents(){var t=[];return this.views&&this.views.forEach(function(i){let s=i&&i.contents;s&&t.push(s);}),t;}direction(t="ltr"){this.settings.direction=t,this.stage&&this.stage.direction(t),this.viewSettings.direction=t,this.updateLayout();}isRendered(){return this.rendered;}}t.f(h)(g.prototype),i.default=g;},"61c5674e":function t(t,s,i,e){t._m(s);var l=i("ef158879"),o=t.i(i("5a6d0fc7")),n=t.i(i("32761f19")),h=i("a043b48d"),r=t.i(i("01c77a7e"));class a extends t.f(o){constructor(t){super(t),this.name="continuous",this.settings=l.extend(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),l.extend(this.settings,t.settings||{}),"undefined"!=t.settings.gap&&0===t.settings.gap&&(this.settings.gap=t.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0;}display(s,i){return t.f(o).prototype.display.call(this,s,i).then((function(){return this.fill();}).bind(this));}fill(t){var s=t||new l.defer;return this.q.enqueue(()=>this.check()).then(t=>{t?this.fill(s):s.resolve();}),s.promise;}moveTo(t){var s=0,i=0;this.isPaginated?s=Math.floor(t.left/this.layout.delta)*this.layout.delta:(i=t.top,t.top),this.settings.offsetDelta,(s>0||i>0)&&this.scrollBy(s,i,!0);}afterResized(t){this.emit(h.EVENTS.MANAGERS.RESIZE,t.section);}removeShownListeners(t){t.onDisplayed=function(){};}add(t){var s=this.createView(t);return this.views.append(s),s.on(h.EVENTS.VIEWS.RESIZED,t=>{s.expanded=!0;}),s.on(h.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t);}),s.on(h.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t);}),s.onDisplayed=this.afterDisplayed.bind(this),s.onResize=this.afterResized.bind(this),s.display(this.request);}append(t){var s=this.createView(t);return s.on(h.EVENTS.VIEWS.RESIZED,t=>{s.expanded=!0;}),s.on(h.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t);}),s.on(h.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t);}),this.views.append(s),s.onDisplayed=this.afterDisplayed.bind(this),s;}prepend(t){var s=this.createView(t);return s.on(h.EVENTS.VIEWS.RESIZED,t=>{this.counter(t),s.expanded=!0;}),s.on(h.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t);}),s.on(h.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t);}),this.views.prepend(s),s.onDisplayed=this.afterDisplayed.bind(this),s;}counter(t){"vertical"===this.settings.axis?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0);}update(t){for(var s,i=this.bounds(),e=this.views.all(),o=e.length,n=[],h=void 0!==t?t:this.settings.offset||0,r=new l.defer,a=[],d=0;d<o;d++)if(s=e[d],!0===this.isVisible(s,h,h,i)){if(s.displayed)s.show();else{let t=s.display(this.request).then(function(t){t.show();},t=>{s.hide();});a.push(t);}n.push(s);}else this.q.enqueue(s.destroy.bind(s)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this));}).bind(this),250);return a.length?Promise.all(a).catch(t=>{r.reject(t);}):(r.resolve(),r.promise);}check(t,s){var i=new l.defer,e=[],o="horizontal"===this.settings.axis,n=this.settings.offset||0;t&&o&&(n=t),s&&!o&&(n=s);var h=this._bounds;let r=o?this.scrollLeft:this.scrollTop,a=o?Math.floor(h.width):h.height,d=o?this.container.scrollWidth:this.container.scrollHeight,c=this.writingMode&&0===this.writingMode.indexOf("vertical")?"vertical":"horizontal",p=this.settings.rtlScrollType,u="rtl"===this.settings.direction;this.settings.fullsize?(o&&u&&"negative"===p||!o&&u&&"default"===p)&&(r*=-1):(u&&"default"===p&&"horizontal"===c&&(r=d-a-r),u&&"negative"===p&&"horizontal"===c&&(r*=-1));let f=r+a+n,g=r-n;f>=d&&(()=>{let t=this.views.last(),s=t&&t.section.next();s&&e.push(this.append(s));})(),g<0&&(()=>{let t=this.views.first(),s=t&&t.section.prev();s&&e.push(this.prepend(s));})();let w=e.map(t=>t.display(this.request));return e.length?Promise.all(w).then(()=>this.check()).then(()=>this.update(n),t=>t):(this.q.enqueue((function(){this.update();}).bind(this)),i.resolve(!1),i.promise);}trim(){for(var t=new l.defer,s=this.views.displayed(),i=s[0],e=s[s.length-1],o=this.views.indexOf(i),n=this.views.indexOf(e),h=this.views.slice(0,o),r=this.views.slice(n+1),a=0;a<h.length-1;a++)this.erase(h[a],h);for(var d=1;d<r.length;d++)this.erase(r[d]);return t.resolve(),t.promise;}erase(t,s){this.settings.fullsize?(i=window.scrollY,e=window.scrollX):(i=this.container.scrollTop,e=this.container.scrollLeft);var i,e,l=t.bounds();this.views.remove(t),s&&("vertical"===this.settings.axis?this.scrollTo(0,i-l.height,!0):"rtl"===this.settings.direction?this.settings.fullsize?this.scrollTo(e+Math.floor(l.width),0,!0):this.scrollTo(e,0,!0):this.scrollTo(e-Math.floor(l.width),0,!0));}addEventListeners(s){window.addEventListener("unload",(function(t){this.ignore=!0,this.destroy();}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new(t.f(n))(this,this.settings.snap&&"object"==typeof this.settings.snap&&this.settings.snap));}addScrollListeners(){var s;this.tick=l.requestAnimationFrame;let i="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(s=window,this.scrollTop=window.scrollY*i,this.scrollLeft=window.scrollX*i):(s=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),s.addEventListener("scroll",this._onScroll),this._scrolled=t.f(r)(this.scrolled.bind(this),30),this.didScroll=!1;}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0;}onScroll(){let t,s;let i="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.settings.fullsize?(t=window.scrollY*i,s=window.scrollX*i):(t=this.container.scrollTop,s=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=s,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(t-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(s-this.prevScrollLeft),this.prevScrollTop=t,this.prevScrollLeft=s,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0;}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1;}scrolled(){this.q.enqueue((function(){return this.check();}).bind(this)),this.emit(h.EVENTS.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(h.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft});}).bind(this),this.settings.afterScrolledTimeout);}next(){let t="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(t,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check();}).bind(this)));}prev(){let t="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(-t,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check();}).bind(this)));}updateFlow(s){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(s,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new(t.f(n))(this,this.settings.snap&&"object"==typeof this.settings.snap&&this.settings.snap));}destroy(){super.destroy(),this.snapper&&this.snapper.destroy();}}s.default=a;},"6256bf23":function t(t,e,r,i){t._m(e);var n=r("ef158879");e.default=class{constructor(t){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,t&&this.parse(t);}parse(t){let e,r,i=t.nodeType;i&&(e=n.qs(t,"html"),r=n.qs(t,"ncx")),i?e?(this.toc=this.parseNav(t),this.landmarks=this.parseLandmarks(t)):r&&(this.toc=this.parseNcx(t)):this.toc=this.load(t),this.length=0,this.unpack(this.toc);}unpack(t){for(var e,r=0;r<t.length;r++)(e=t[r]).href&&(this.tocByHref[e.href]=r),e.id&&(this.tocById[e.id]=r),this.length++,e.subitems.length&&this.unpack(e.subitems);}get(t){var e;return t?(0===t.indexOf("#")?e=this.tocById[t.substring(1)]:t in this.tocByHref&&(e=this.tocByHref[t]),this.getByIndex(t,e,this.toc)):this.toc;}getByIndex(t,e,r){if(0===r.length)return;let i=r[e];if(i&&(t===i.id||t===i.href))return i;{let i;for(let n=0;n<r.length&&!(i=this.getByIndex(t,e,r[n].subitems));++n);return i;}}landmark(t){var e;return t?(e=this.landmarksByType[t],this.landmarks[e]):this.landmarks;}parseNav(t){var e=n.querySelectorByType(t,"nav","toc"),r=[];if(!e)return r;let i=n.filterChildren(e,"ol",!0);return i?r=this.parseNavList(i):r;}parseNavList(t,e){let r=[];if(!t||!t.children)return r;for(let i=0;i<t.children.length;i++){let n=this.navItem(t.children[i],e);n&&r.push(n);}return r;}navItem(t,e){let r=t.getAttribute("id")||void 0,i=n.filterChildren(t,"a",!0)||n.filterChildren(t,"span",!0);if(!i)return;let s=i.getAttribute("href")||"";r||(r=s);let a=i.textContent||"",h=[],l=n.filterChildren(t,"ol",!0);return l&&(h=this.parseNavList(l,r)),{id:r,href:s,label:a,subitems:h,parent:e};}parseLandmarks(t){var e,r,i=n.querySelectorByType(t,"nav","landmarks"),s=i?n.qsa(i,"li"):[],a=s.length,h=[];if(!s||0===a)return h;for(e=0;e<a;++e)(r=this.landmarkItem(s[e]))&&(h.push(r),this.landmarksByType[r.type]=e);return h;}landmarkItem(t){let e=n.filterChildren(t,"a",!0);if(!e)return;let r=e.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0;return{href:e.getAttribute("href")||"",label:e.textContent||"",type:r};}parseNcx(t){var e,r,i=n.qsa(t,"navPoint"),s=i.length,a={},h=[];if(!i||0===s)return h;for(e=0;e<s;++e)a[(r=this.ncxItem(i[e])).id]=r,r.parent?a[r.parent].subitems.push(r):h.push(r);return h;}ncxItem(t){var e,r=t.getAttribute("id")||!1,i=n.qs(t,"content").getAttribute("src"),s=n.qs(t,"navLabel"),a=s.textContent?s.textContent:"",h=t.parentNode;return h&&("navPoint"===h.nodeName||"navPoint"===h.nodeName.split(":").slice(-1)[0])&&(e=h.getAttribute("id")),{id:r,href:i,label:a,subitems:[],parent:e};}load(t){return t.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t));}forEach(t){return this.toc.forEach(t);}};},"66e307a0":function t(t,n,i,e){t._m(n);var s=t.i(i("fc84397d")),o=t.i(i("bf80adb5")),a=i("a043b48d");class h{constructor({type:t,cfiRange:n,data:i,sectionIndex:e,cb:s,className:o,styles:a}){this.type=t,this.cfiRange=n,this.data=i,this.sectionIndex=e,this.mark=void 0,this.cb=s,this.className=o,this.styles=a;}update(t){this.data=t;}attach(t){let n,{cfiRange:i,data:e,type:s,mark:o,cb:h,className:r,styles:d}=this;return"highlight"===s?n=t.highlight(i,e,h,r,d):"underline"===s?n=t.underline(i,e,h,r,d):"mark"===s&&(n=t.mark(i,e,h)),this.mark=n,this.emit(a.EVENTS.ANNOTATION.ATTACH,n),n;}detach(t){let n,{cfiRange:i,type:e}=this;return t&&("highlight"===e?n=t.unhighlight(i):"underline"===e?n=t.ununderline(i):"mark"===e&&(n=t.unmark(i))),this.mark=void 0,this.emit(a.EVENTS.ANNOTATION.DETACH,n),n;}text(){}}t.f(s)(h.prototype),n.default=class{constructor(t){this.rendition=t,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this));}add(n,i,e,s,a,r){let d=encodeURI(i+n),c=new(t.f(o))(i).spinePos,l=new h({type:n,cfiRange:i,data:e,sectionIndex:c,cb:s,className:a,styles:r});return this._annotations[d]=l,c in this._annotationsBySectionIndex?this._annotationsBySectionIndex[c].push(d):this._annotationsBySectionIndex[c]=[d],this.rendition.views().forEach(t=>{l.sectionIndex===t.index&&l.attach(t);}),l;}remove(t,n){let i=encodeURI(t+n);if(i in this._annotations){let t=this._annotations[i];if(n&&t.type!==n)return;this.rendition.views().forEach(n=>{this._removeFromAnnotationBySectionIndex(t.sectionIndex,i),t.sectionIndex===n.index&&t.detach(n);}),delete this._annotations[i];}}_removeFromAnnotationBySectionIndex(t,n){this._annotationsBySectionIndex[t]=this._annotationsAt(t).filter(t=>t!==n);}_annotationsAt(t){return this._annotationsBySectionIndex[t];}highlight(t,n,i,e,s){return this.add("highlight",t,n,i,e,s);}underline(t,n,i,e,s){return this.add("underline",t,n,i,e,s);}mark(t,n,i){return this.add("mark",t,n,i);}each(){return this._annotations.forEach.apply(this._annotations,arguments);}inject(t){let n=t.index;n in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[n].forEach(n=>{this._annotations[n].attach(t);});}clear(t){let n=t.index;n in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[n].forEach(n=>{this._annotations[n].detach(t);});}show(){}hide(){}};},"671ca8e7":function t(t,e,r,i){t._m(e);var n=t.i(r("bf80adb5")),o=r("ef158879");e.default=class{constructor(t,e,r,i=!1){this.layout=t,this.horizontal="horizontal"===r,this.direction=e||"ltr",this._dev=i;}section(t){var e=this.findRanges(t);return this.rangeListToCfiList(t.section.cfiBase,e);}page(e,r,i,o){var a,s=!!e&&!!e.document&&e.document.body;if(s){if(a=this.rangePairToCfiPair(r,{start:this.findStart(s,i,o),end:this.findEnd(s,i,o)}),!0===this._dev){let r=e.document,i=new(t.f(n))(a.start).toRange(r),o=new(t.f(n))(a.end).toRange(r),s=r.defaultView.getSelection(),h=r.createRange();s.removeAllRanges(),h.setStart(i.startContainer,i.startOffset),h.setEnd(o.endContainer,o.endOffset),s.addRange(h);}return a;}}walk(t,e){if(!t||t.nodeType!==Node.TEXT_NODE){var r,i,n=function(t){return t.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT;};n.acceptNode=n;for(var o=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,n,!1);(r=o.nextNode())&&!(i=e(r)););return i;}}findRanges(t){for(var e,r,i=[],n=Math.ceil(t.contents.scrollWidth()/this.layout.spreadWidth)*this.layout.divisor,o=this.layout.columnWidth,a=this.layout.gap,s=0;s<n.pages;s++)e=(o+a)*s,r=o*(s+1)+a*s,i.push({start:this.findStart(t.document.body,e,r),end:this.findEnd(t.document.body,e,r)});return i;}findStart(t,e,r){for(var i,n,a=[t],s=t;a.length;)if(i=a.shift(),n=this.walk(i,t=>{var i,n,h,d,f;if(f=o.nodeBounds(t),this.horizontal&&"ltr"===this.direction){if(i=this.horizontal?f.left:f.top,n=this.horizontal?f.right:f.bottom,i>=e&&i<=r||n>e)return t;s=t,a.push(t);}else if(this.horizontal&&"rtl"===this.direction){if(i=f.left,(n=f.right)<=r&&n>=e||i<r)return t;s=t,a.push(t);}else{if(h=f.top,d=f.bottom,h>=e&&h<=r||d>e)return t;s=t,a.push(t);}}))return this.findTextStartRange(n,e,r);return this.findTextStartRange(s,e,r);}findEnd(t,e,r){for(var i,n,a=[t],s=t;a.length;)if(i=a.shift(),n=this.walk(i,t=>{var i,n,h,d,f;if(f=o.nodeBounds(t),this.horizontal&&"ltr"===this.direction){if(i=Math.round(f.left),n=Math.round(f.right),i>r&&s)return s;if(n>r)return t;s=t,a.push(t);}else if(this.horizontal&&"rtl"===this.direction){if(i=Math.round(this.horizontal?f.left:f.top),(n=Math.round(this.horizontal?f.right:f.bottom))<e&&s)return s;if(i<e)return t;s=t,a.push(t);}else{if(h=Math.round(f.top),d=Math.round(f.bottom),h>r&&s)return s;if(d>r)return t;s=t,a.push(t);}}))return this.findTextEndRange(n,e,r);return this.findTextEndRange(s,e,r);}findTextStartRange(t,e,r){for(var i,n,o=this.splitTextNodeIntoRanges(t),a=0;a<o.length;a++)if(n=(i=o[a]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(n.left>=e)return i;}else if(this.horizontal&&"rtl"===this.direction){if(n.right<=r)return i;}else if(n.top>=e)return i;return o[0];}findTextEndRange(t,e,r){for(var i,n,o,a,s,h,d,f=this.splitTextNodeIntoRanges(t),l=0;l<f.length;l++){if(o=(n=f[l]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(a=o.left,s=o.right,a>r&&i)return i;if(s>r)return n;}else if(this.horizontal&&"rtl"===this.direction){if(a=o.left,(s=o.right)<e&&i)return i;if(a<e)return n;}else{if(h=o.top,d=o.bottom,h>r&&i)return i;if(d>r)return n;}i=n;}return f[f.length-1];}splitTextNodeIntoRanges(t,e){var r,i=[],n=(t.textContent||"").trim(),o=t.ownerDocument,a=e||" ",s=n.indexOf(a);if(-1===s||t.nodeType!=Node.TEXT_NODE)return(r=o.createRange()).selectNodeContents(t),[r];for((r=o.createRange()).setStart(t,0),r.setEnd(t,s),i.push(r),r=!1;-1!=s;)(s=n.indexOf(a,s+1))>0&&(r&&(r.setEnd(t,s),i.push(r)),(r=o.createRange()).setStart(t,s+1));return r&&(r.setEnd(t,n.length),i.push(r)),i;}rangePairToCfiPair(e,r){var i=r.start,o=r.end;return i.collapse(!0),o.collapse(!1),{start:new(t.f(n))(i,e).toString(),end:new(t.f(n))(o,e).toString()};}rangeListToCfiList(t,e){for(var r=[],i=0;i<e.length;i++)r.push(this.rangePairToCfiPair(t,e[i]));return r;}axis(t){return t&&(this.horizontal="horizontal"===t),this.horizontal;}};},"6f914524":function t(t,e,i,n){t._m(e);var s=i("ef158879"),o=t.i(i("af202c04"));e.default=class{constructor(t){this.settings=t||{},this.id="epubjs-container-"+s.uuid(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container));}create(t){let e=t.height,i=t.width,n=t.overflow||!1,o=t.axis||"vertical",r=t.direction;s.extend(this.settings,t),t.height&&s.isNumber(t.height)&&(e=t.height+"px"),t.width&&s.isNumber(t.width)&&(i=t.width+"px");let h=document.createElement("div");return h.id=this.id,h.classList.add("epub-container"),h.style.wordSpacing="0",h.style.lineHeight="0",h.style.verticalAlign="top",h.style.position="relative","horizontal"===o&&(h.style.display="flex",h.style.flexDirection="row",h.style.flexWrap="nowrap"),i&&(h.style.width=i),e&&(h.style.height=e),n&&("scroll"===n&&"vertical"===o?(h.style["overflow-y"]=n,h.style["overflow-x"]="hidden"):"scroll"===n&&"horizontal"===o?(h.style["overflow-y"]="hidden",h.style["overflow-x"]=n):h.style.overflow=n),r&&(h.dir=r,h.style.direction=r),r&&this.settings.fullsize&&(document.body.style.direction=r),h;}wrap(t){var e=document.createElement("div");return e.style.visibility="hidden",e.style.overflow="hidden",e.style.width="0",e.style.height="0",e.appendChild(t),e;}getElement(t){var e;if(s.isElement(t)?e=t:"string"==typeof t&&(e=document.getElementById(t)),!e)throw Error("Not an Element");return e;}attachTo(t){var e,i=this.getElement(t);if(i)return e=this.settings.hidden?this.wrapper:this.container,i.appendChild(e),this.element=i,i;}getContainer(){return this.container;}onResize(e){s.isNumber(this.settings.width)&&s.isNumber(this.settings.height)||(this.resizeFunc=t.f(o)(e,50),window.addEventListener("resize",this.resizeFunc,!1));}onOrientationChange(t){this.orientationChangeFunc=t,window.addEventListener("orientationchange",this.orientationChangeFunc,!1);}size(t,e){var i;let n=t||this.settings.width,o=e||this.settings.height;null===t?(i=this.element.getBoundingClientRect()).width&&(t=Math.floor(i.width),this.container.style.width=t+"px"):s.isNumber(t)?this.container.style.width=t+"px":this.container.style.width=t,null===e?(i=i||this.element.getBoundingClientRect()).height&&(e=i.height,this.container.style.height=e+"px"):s.isNumber(e)?this.container.style.height=e+"px":this.container.style.height=e,s.isNumber(t)||(t=this.container.clientWidth),s.isNumber(e)||(e=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let r=s.windowBounds(),h=window.getComputedStyle(document.body),l={left:parseFloat(h["padding-left"])||0,right:parseFloat(h["padding-right"])||0,top:parseFloat(h["padding-top"])||0,bottom:parseFloat(h["padding-bottom"])||0};return n||(t=r.width-l.left-l.right),(!this.settings.fullsize||o)&&o||(e=r.height-l.top-l.bottom),{width:t-this.containerPadding.left-this.containerPadding.right,height:e-this.containerPadding.top-this.containerPadding.bottom};}bounds(){let t;return("visible"!==this.container.style.overflow&&(t=this.container&&this.container.getBoundingClientRect()),t&&t.width&&t.height)?t:s.windowBounds();}getSheet(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet;}addStyleRules(t,e){var i="#"+this.id+" ",n="";this.sheet||(this.sheet=this.getSheet()),e.forEach(function(t){for(var e in t)t.hasOwnProperty(e)&&(n+=e+":"+t[e]+";");}),this.sheet.insertRule(i+t+" {"+n+"}",0);}axis(t){"horizontal"===t?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=t;}direction(t){this.container&&(this.container.dir=t,this.container.style.direction=t),this.settings.fullsize&&(document.body.style.direction=t),this.settings.dir=t;}overflow(t){this.container&&("scroll"===t&&"vertical"===this.settings.axis?(this.container.style["overflow-y"]=t,this.container.style["overflow-x"]="hidden"):"scroll"===t&&"horizontal"===this.settings.axis?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=t):this.container.style.overflow=t),this.settings.overflow=t;}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc));}};},"6fa060c7":function e(e,t,i,s){e._m(t);var r=e.i(i("7fa13d64"));t.default=class{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this));}register(){return 0==arguments.length?void 0:1==arguments.length&&"object"==typeof arguments[0]?this.registerThemes(arguments[0]):1==arguments.length&&"string"==typeof arguments[0]?this.default(arguments[0]):2==arguments.length&&"string"==typeof arguments[1]?this.registerUrl(arguments[0],arguments[1]):2==arguments.length&&"object"==typeof arguments[1]?this.registerRules(arguments[0],arguments[1]):void 0;}default(e){return e?"string"==typeof e?this.registerUrl("default",e):"object"==typeof e?this.registerRules("default",e):void 0:void 0;}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&("string"==typeof e[t]?this.registerUrl(t,e[t]):this.registerRules(t,e[t]));}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||"default"==e)&&this.update(e);}registerUrl(t,i){var s=new(e.f(r))(i);this._themes[t]={url:s.toString()},(this._injected[t]||"default"==t)&&this.update(t);}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||"default"==e)&&this.update(e);}select(e){var t=this._current;this._current=e,this.update(e),this.rendition.getContents().forEach(i=>{i.removeClass(t),i.addClass(e);});}update(e){this.rendition.getContents().forEach(t=>{this.add(e,t);});}inject(e){var t,i=[],s=this._themes;for(var r in s)s.hasOwnProperty(r)&&(r===this._current||"default"===r)&&(((t=s[r]).rules&&Object.keys(t.rules).length>0||t.url&&-1===i.indexOf(t.url))&&this.add(r,e),this._injected.push(r));"default"!=this._current&&e.addClass(this._current);}add(e,t){var i=this._themes[e];i&&t&&(i.url?t.addStylesheet(i.url):i.serialized?(t.addStylesheetCss(i.serialized,e),i.injected=!0):i.rules&&(t.addStylesheetRules(i.rules,e),i.injected=!0));}override(e,t,i){var s=this.rendition.getContents();this._overrides[e]={value:t,priority:!0===i},s.forEach(t=>{t.css(e,this._overrides[e].value,this._overrides[e].priority);});}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(t=>{t.css(e);});}overrides(e){var t=this._overrides;for(var i in t)t.hasOwnProperty(i)&&e.css(i,t[i].value,t[i].priority);}fontSize(e){this.override("font-size",e);}font(e){this.override("font-family",e,!0);}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0;}};},"70a38bc9":function t(t,e,i,n){t._m(e);var r=i("ef158879"),o=t.i(i("bf80adb5")),s=t.i(i("f9cf22ea")),h=i("ef158879"),c=i("ce74a605"),a=t.i(i("d9d2ff27")),u=i("57789411");e.default=class{constructor(e,i){this.idref=e.idref,this.linear="yes"===e.linear,this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,i?this.hooks=i:(this.hooks={},this.hooks.serialize=new(t.f(s))(this),this.hooks.content=new(t.f(s))(this)),this.document=void 0,this.contents=void 0,this.output=void 0;}load(e){var i=e||this.request||t.f(a),n=new r.defer,o=n.promise;return this.contents?n.resolve(this.contents):i(this.url).then((function(t){return this.document=t,this.contents=t.documentElement,this.hooks.content.trigger(this.document,this);}).bind(this)).then((function(){n.resolve(this.contents);}).bind(this)).catch(function(t){n.reject(t);}),o;}base(){return c.replaceBase(this.document,this);}render(t){var e=new r.defer,i=e.promise;return this.output,this.load(t).then((function(t){var e,i=("undefined"!=typeof navigator&&navigator.userAgent||"").indexOf("Trident")>=0;"undefined"==typeof XMLSerializer||i?e=u.DOMParser:e=XMLSerializer;var n=new e;return this.output=n.serializeToString(t),this.output;}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this);}).bind(this)).then((function(){e.resolve(this.output);}).bind(this)).catch(function(t){e.reject(t);}),i;}find(t){var e=this,i=[],n=t.toLowerCase(),r=function(t){for(var r,o,s,h=t.textContent.toLowerCase(),c=e.document.createRange(),a=-1;-1!=o;)-1!=(o=h.indexOf(n,a+1))&&((c=e.document.createRange()).setStart(t,o),c.setEnd(t,o+n.length),r=e.cfiFromRange(c),s=t.textContent.length<150?t.textContent:"..."+(s=t.textContent.substring(o-75,o+75))+"...",i.push({cfi:r,excerpt:s})),a=o;};return h.sprint(e.document,function(t){r(t);}),i;}search(t,e=5){if(void 0===document.createTreeWalker)return this.find(t);let i=[],n=this,r=t.toLowerCase(),o=function(t){let e=t.reduce((t,e)=>t+e.textContent,"").toLowerCase().indexOf(r);if(-1!=e){let o=e+r.length,s=0,h=0;if(e<t[0].length){let r;for(;s<t.length-1&&!(o<=(h+=t[s].length));)s+=1;let c=t[0],a=t[s],u=n.document.createRange();u.setStart(c,e);let d=t.slice(0,s).reduce((t,e)=>t+e.textContent.length,0);u.setEnd(a,d>o?o:o-d),r=n.cfiFromRange(u);let f=t.slice(0,s+1).reduce((t,e)=>t+e.textContent,"");f.length>150&&(f="..."+(f=f.substring(e-75,e+75))+"..."),i.push({cfi:r,excerpt:f});}}},s=document.createTreeWalker(n.document,NodeFilter.SHOW_TEXT,null,!1),h,c=[];for(;h=s.nextNode();)c.push(h),c.length==e&&(o(c.slice(0,e)),c=c.slice(1,e));return c.length>0&&o(c),i;}reconcileLayoutSettings(t){var e={layout:t.layout,spread:t.spread,orientation:t.orientation};return this.properties.forEach(function(t){var i,n,r=t.replace("rendition:",""),o=r.indexOf("-");-1!=o&&(i=r.slice(0,o),n=r.slice(o+1),e[i]=n);}),e;}cfiFromRange(e){return new(t.f(o))(e,this.cfiBase).toString();}cfiFromElement(e){return new(t.f(o))(e,this.cfiBase).toString();}unload(){this.document=void 0,this.contents=void 0,this.output=void 0;}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0;}};},"7175b0cb":function a(a,d,e,f){a._m(d),e("19a8aec4"),e("2a020ec6"),e("8fb0147d"),e("0668a852");var c=a.i(e("d69de0d3"));d.default=a.f(c);},"77c3e88b":function t(t,e,s,i){t._m(e);var a=t.i(s("bf80adb5")),r=s("ef158879");e.default=class{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new(t.f(a)),this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList);}parse(t){var e=r.qs(t,"html"),s=r.qs(t,"ncx");return e?this.parseNav(t):s?this.parseNcx(t):void 0;}parseNav(t){var e,s=r.querySelectorByType(t,"nav","page-list"),i=s?r.qsa(s,"li"):[],a=i.length,h=[];if(!i||0===a)return h;for(e=0;e<a;++e)h.push(this.item(i[e]));return h;}parseNcx(t){var e,s,i=[],a=0,h=0;if(!(e=r.qs(t,"pageList"))||(h=(s=r.qsa(e,"pageTarget")).length,!s||0===s.length))return i;for(a=0;a<h;++a)i.push(this.ncxItem(s[a]));return i;}ncxItem(t){var e=r.qs(t,"navLabel"),s=r.qs(e,"text").textContent;return{href:r.qs(t,"content").getAttribute("src"),page:parseInt(s,10)};}item(t){var e,s,i=r.qs(t,"a"),a=i.getAttribute("href")||"",h=parseInt(i.textContent||"");return -1!=a.indexOf("epubcfi")?(s=(e=a.split("#"))[0],{cfi:e.length>1&&e[1],href:a,packageUrl:s,page:h}):{href:a,page:h};}process(t){t.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi);},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage;}pageFromCfi(t){var e=-1;if(0===this.locations.length)return -1;var s=r.indexOfSorted(t,this.locations,this.epubcfi.compare);return -1!=s?e=this.pages[s]:void 0!==(e=(s=r.locationOf(t,this.locations,this.epubcfi.compare))-1>=0?this.pages[s-1]:this.pages[0])||(e=-1),e;}cfiFromPage(t){var e=-1;"number"!=typeof t&&(t=parseInt(t));var s=this.pages.indexOf(t);return -1!=s&&(e=this.locations[s]),e;}pageFromPercentage(t){return Math.round(this.totalPages*t);}percentageFromPage(t){return Math.round(1e3*((t-this.firstPage)/this.totalPages))/1e3;}percentageFromCfi(t){var e=this.pageFromCfi(t);return this.percentageFromPage(e);}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0;}};},"77c5c406":function e(e,t,i,s){e._m(t);var n=i("ef158879");t.default=class{constructor(e){this._q=[],this.context=e,this.tick=n.requestAnimationFrame,this.running=!1,this.paused=!1;}enqueue(){var e,t,i,s=[].shift.call(arguments),r=arguments;if(!s)throw Error("No Task Provided");return"function"==typeof s?(t=(e=new n.defer).promise,i={task:s,args:r,deferred:e,promise:t}):i={promise:s},this._q.push(i),!1!=this.paused||this.running||this.run(),i.promise;}dequeue(){var e,t,i;return!this._q.length||this.paused?((e=new n.defer).deferred.resolve(),e.promise):(t=(e=this._q.shift()).task)?(i=t.apply(this.context,e.args))&&"function"==typeof i.then?i.then((function(){e.deferred.resolve.apply(this.context,arguments);}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments);}).bind(this)):(e.deferred.resolve.apply(this.context,i),e.promise):e.promise?e.promise:void 0;}dump(){for(;this._q.length;)this.dequeue();}run(){return this.running||(this.running=!0,this.defered=new n.defer),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run();}).bind(this)):(this.defered.resolve(),this.running=void 0);}),!0==this.paused&&(this.paused=!1),this.defered.promise;}flush(){return this.running?this.running:this._q.length?(this.running=this.dequeue().then((function(){return this.running=void 0,this.flush();}).bind(this)),this.running):void 0;}clear(){this._q=[];}length(){return this._q.length;}pause(){this.paused=!0;}stop(){this._q=[],this.running=!1,this.paused=!0;}};},"7c6257d0":function i(i,e,t,s){i._m(e),e.default=class{constructor(i){this.container=i,this._views=[],this.length=0,this.hidden=!1;}all(){return this._views;}first(){return this._views[0];}last(){return this._views[this._views.length-1];}indexOf(i){return this._views.indexOf(i);}slice(){return this._views.slice.apply(this._views,arguments);}get(i){return this._views[i];}append(i){return this._views.push(i),this.container&&this.container.appendChild(i.element),this.length++,i;}prepend(i){return this._views.unshift(i),this.container&&this.container.insertBefore(i.element,this.container.firstChild),this.length++,i;}insert(i,e){return this._views.splice(e,0,i),this.container&&(e<this.container.children.length?this.container.insertBefore(i.element,this.container.children[e]):this.container.appendChild(i.element)),this.length++,i;}remove(i){var e=this._views.indexOf(i);e>-1&&this._views.splice(e,1),this.destroy(i),this.length--;}destroy(i){i.displayed&&i.destroy(),this.container&&this.container.removeChild(i.element),i=null;}forEach(){return this._views.forEach.apply(this._views,arguments);}clear(){var i,e=this.length;if(this.length){for(var t=0;t<e;t++)i=this._views[t],this.destroy(i);this._views=[],this.length=0;}}find(i){for(var e,t=this.length,s=0;s<t;s++)if((e=this._views[s]).displayed&&e.section.index==i.index)return e;}displayed(){for(var i,e=[],t=this.length,s=0;s<t;s++)(i=this._views[s]).displayed&&e.push(i);return e;}show(){for(var i,e=this.length,t=0;t<e;t++)(i=this._views[t]).displayed&&i.show();this.hidden=!1;}hide(){for(var i,e=this.length,t=0;t<e;t++)(i=this._views[t]).displayed&&i.hide();this.hidden=!0;}};},"7fa13d64":function t(t,i,h,s){t._m(i);var r=t.i(h("f85cdffd")),e=t.i(h("789f8ab1"));i.default=class{constructor(i,h){var s=i.indexOf("://")>-1,e=i;if(this.Url=void 0,this.href=i,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=h,!s&&!1!==h&&"string"!=typeof h&&window&&window.location&&(this.base=window.location.href),s||this.base)try{this.base?this.Url=new URL(i,this.base):this.Url=new URL(i),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,e=this.Url.pathname+(this.Url.search?this.Url.search:"");}catch(i){this.Url=void 0,this.base&&(e=new(t.f(r))(this.base).resolve(e));}this.Path=new(t.f(r))(e),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension;}path(){return this.Path;}resolve(i){var h;return i.indexOf("://")>-1?i:(h=t.f(e).resolve(this.directory,i),this.origin+h);}relative(i){return t.f(e).relative(i,this.directory);}toString(){return this.href;}};},"7faf87b1":function e(e,t,n,i){e._m(t);var r=n("ef158879"),s=e.i(n("d9d2ff27")),o=e.i(n("0f707ffe")),a=e.i(n("f85cdffd")),h=e.i(n("15aa5f31"));t.default=class{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements();}checkRequirements(){try{this.zip=new(e.f(h));}catch(e){throw Error("JSZip lib not loaded");}}open(e,t){return this.zip.loadAsync(e,{base64:t});}openUrl(t,n){return e.f(s)(t,"binary").then((function(e){return this.zip.loadAsync(e,{base64:n});}).bind(this));}request(t,n){var i,s=new r.defer,o=new(e.f(a))(t);return n||(n=o.extension),(i="blob"==n?this.getBlob(t):this.getText(t))?i.then((function(e){let t=this.handleResponse(e,n);s.resolve(t);}).bind(this)):s.reject({message:"File not found in the epub: "+t,stack:Error().stack}),s.promise;}handleResponse(e,t){return"json"==t?JSON.parse(e):r.isXml(t)?r.parse(e,"text/xml"):"xhtml"==t?r.parse(e,"application/xhtml+xml"):"html"==t||"htm"==t?r.parse(e,"text/html"):e;}getBlob(t,n){var i=window.decodeURIComponent(t.substr(1)),r=this.zip.file(i);if(r)return n=n||e.f(o).lookup(r.name),r.async("uint8array").then(function(e){return new Blob([e],{type:n});});}getText(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return i.async("string").then(function(e){return e;});}getBase64(t,n){var i=window.decodeURIComponent(t.substr(1)),r=this.zip.file(i);if(r)return n=n||e.f(o).lookup(r.name),r.async("base64").then(function(e){return"data:"+n+";base64,"+e;});}createUrl(e,t){var n,i,s=new r.defer,o=window.URL||window.webkitURL||window.mozURL,a=t&&t.base64;return e in this.urlCache?s.resolve(this.urlCache[e]):(a?(i=this.getBase64(e))&&i.then((function(t){this.urlCache[e]=t,s.resolve(t);}).bind(this)):(i=this.getBlob(e))&&i.then((function(t){n=o.createObjectURL(t),this.urlCache[e]=n,s.resolve(n);}).bind(this)),i||s.reject({message:"File not found in the epub: "+e,stack:Error().stack})),s.promise;}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n);}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={};}};},"83acacd7":function t(t,i,o,r){t._m(i);var a=t.i(o("789f8ab1")),e=o("ef158879");i.default=class{constructor(t){this.packagePath="",this.directory="",this.encoding="",t&&this.parse(t);}parse(i){var o;if(!i)throw Error("Container File Not Found");if(!(o=e.qs(i,"rootfile")))throw Error("No RootFile Found");this.packagePath=o.getAttribute("full-path"),this.directory=t.f(a).dirname(this.packagePath),this.encoding=i.xmlEncoding;}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0;}};},"8fb0147d":function t(t,e,i,s){t._m(e);var n=t.i(i("fc84397d")),o=i("ef158879"),r=t.i(i("bf80adb5")),h=t.i(i("671ca8e7")),a=i("ce74a605"),d=i("a043b48d");let c="undefined"!=typeof navigator,l=c&&/Chrome/.test(navigator.userAgent),u=c&&!l&&/AppleWebKit/.test(navigator.userAgent);class m{constructor(e,i,s,n){this.epubcfi=new(t.f(r)),this.document=e,this.documentElement=this.document.documentElement,this.content=i||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=n||0,this.cfiBase=s||"",this.epubReadingSystem("epub.js",d.EPUBJS_VERSION),this.called=0,this.active=!0,this.listeners();}static get listenedEvents(){return d.DOM_EVENTS;}width(t){var e=this.content;return t&&o.isNumber(t)&&(t+="px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width);}height(t){var e=this.content;return t&&o.isNumber(t)&&(t+="px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height);}contentWidth(t){var e=this.content||this.document.body;return t&&o.isNumber(t)&&(t+="px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width);}contentHeight(t){var e=this.content||this.document.body;return t&&o.isNumber(t)&&(t+="px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height);}textWidth(){let t;let e=this.document.createRange(),i=this.content||this.document.body,s=o.borders(i);return e.selectNodeContents(i),t=e.getBoundingClientRect().width,s&&s.width&&(t+=s.width),Math.round(t);}textHeight(){let t=this.document.createRange(),e=this.content||this.document.body;return t.selectNodeContents(e),Math.round(t.getBoundingClientRect().bottom);}scrollWidth(){return this.documentElement.scrollWidth;}scrollHeight(){return this.documentElement.scrollHeight;}overflow(t){return t&&(this.documentElement.style.overflow=t),this.window.getComputedStyle(this.documentElement).overflow;}overflowX(t){return t&&(this.documentElement.style.overflowX=t),this.window.getComputedStyle(this.documentElement).overflowX;}overflowY(t){return t&&(this.documentElement.style.overflowY=t),this.window.getComputedStyle(this.documentElement).overflowY;}css(t,e,i){var s=this.content||this.document.body;return e?s.style.setProperty(t,e,i?"important":""):s.style.removeProperty(t),this.window.getComputedStyle(s)[t];}viewport(t){var e=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},s=[],n={};if(e&&e.hasAttribute("content")){let t=e.getAttribute("content"),s=t.match(/width\s*=\s*([^,]*)/),n=t.match(/height\s*=\s*([^,]*)/),o=t.match(/initial-scale\s*=\s*([^,]*)/),r=t.match(/minimum-scale\s*=\s*([^,]*)/),h=t.match(/maximum-scale\s*=\s*([^,]*)/),a=t.match(/user-scalable\s*=\s*([^,]*)/);s&&s.length&&void 0!==s[1]&&(i.width=s[1]),n&&n.length&&void 0!==n[1]&&(i.height=n[1]),o&&o.length&&void 0!==o[1]&&(i.scale=o[1]),r&&r.length&&void 0!==r[1]&&(i.minimum=r[1]),h&&h.length&&void 0!==h[1]&&(i.maximum=h[1]),a&&a.length&&void 0!==a[1]&&(i.scalable=a[1]);}return n=o.defaults(t||{},i),t&&(n.width&&s.push("width="+n.width),n.height&&s.push("height="+n.height),n.scale&&s.push("initial-scale="+n.scale),"no"===n.scalable?(s.push("minimum-scale="+n.scale),s.push("maximum-scale="+n.scale),s.push("user-scalable="+n.scalable)):(n.scalable&&s.push("user-scalable="+n.scalable),n.minimum&&s.push("minimum-scale="+n.minimum),n.maximum&&s.push("minimum-scale="+n.maximum)),e||((e=this.document.createElement("meta")).setAttribute("name","viewport"),this.document.querySelector("head").appendChild(e)),e.setAttribute("content",s.join(", ")),this.window.scrollTo(0,0)),n;}expand(){this.emit(d.EVENTS.CONTENTS.EXPAND);}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),"undefined"==typeof ResizeObserver?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler();}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding);}resizeCheck(){let t=this.textWidth(),e=this.textHeight();(t!=this._size.width||e!=this._size.height)&&(this._size={width:t,height:e},this.onResize&&this.onResize(this._size),this.emit(d.EVENTS.CONTENTS.RESIZE,this._size));}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350);}visibilityListeners(){document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&!1===this.active?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding));});}transitionListeners(){let t=this.content;t.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",t.style.transitionDuration="0.001ms",t.style.transitionTimingFunction="linear",t.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck);}mediaQueryListeners(){for(var t,e=this.document.styleSheets,i=(function(t){t.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1);}).bind(this),s=0;s<e.length;s+=1){try{t=e[s].cssRules;}catch(t){return;}if(!t)return;for(var n=0;n<t.length;n+=1)t[n].media&&this.window.matchMedia(t[n].media.mediaText).addListener(i);}}resizeObservers(){this.observer=new ResizeObserver(t=>{requestAnimationFrame(this.resizeCheck.bind(this));}),this.observer.observe(this.document.documentElement);}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck();}),this.observer.observe(this.document,{attributes:!0,childList:!0,characterData:!0,subtree:!0});}imageLoadListeners(){for(var t,e=this.document.querySelectorAll("img"),i=0;i<e.length;i++)void 0!==(t=e[i]).naturalWidth&&0===t.naturalWidth&&(t.onload=this.expand.bind(this));}fontLoadListeners(){this.document&&this.document.fonts&&this.document.fonts.ready.then((function(){this.resizeCheck();}).bind(this));}root(){return this.document?this.document.documentElement:null;}locationOf(e,i){var s,n={left:0,top:0};if(!this.document)return n;if(this.epubcfi.isCfiString(e)){let o=new(t.f(r))(e).toRange(this.document,i);if(o){try{if(!o.endContainer||o.startContainer==o.endContainer&&o.startOffset==o.endOffset){let t=o.startContainer.textContent.indexOf(" ",o.startOffset);-1==t&&(t=o.startContainer.textContent.length),o.setEnd(o.startContainer,t);}}catch(t){console.error("setting end offset to start container length failed",t);}if(o.startContainer.nodeType===Node.ELEMENT_NODE)s=o.startContainer.getBoundingClientRect(),n.left=s.left,n.top=s.top;else if(u){let t=o.startContainer,e=new Range;try{1===t.nodeType?s=t.getBoundingClientRect():o.startOffset+2<t.length?(e.setStart(t,o.startOffset),e.setEnd(t,o.startOffset+2),s=e.getBoundingClientRect()):o.startOffset-2>0?(e.setStart(t,o.startOffset-2),e.setEnd(t,o.startOffset),s=e.getBoundingClientRect()):s=t.parentNode.getBoundingClientRect();}catch(t){console.error(t,t.stack);}}else s=o.getBoundingClientRect();}}else if("string"==typeof e&&e.indexOf("#")>-1){let t=e.substring(e.indexOf("#")+1),i=this.document.getElementById(t);if(i){if(u){let t=new Range;t.selectNode(i),s=t.getBoundingClientRect();}else s=i.getBoundingClientRect();}}return s&&(n.left=s.left,n.top=s.top),n;}addStylesheet(t){return new Promise((function(e,i){var s,n=!1;if(!this.document){e(!1);return;}if(s=this.document.querySelector("link[href='"+t+"']")){e(!0);return;}(s=this.document.createElement("link")).type="text/css",s.rel="stylesheet",s.href=t,s.onload=s.onreadystatechange=function(){n||this.readyState&&"complete"!=this.readyState||(n=!0,setTimeout(()=>{e(!0);},1));},this.document.head.appendChild(s);}).bind(this));}_getStylesheetNode(t){var e;return t="epubjs-inserted-css-"+(t||""),!!this.document&&((e=this.document.getElementById(t))||((e=this.document.createElement("style")).id=t,this.document.head.appendChild(e)),e);}addStylesheetCss(t,e){return!!this.document&&!!t&&(this._getStylesheetNode(e).innerHTML=t,!0);}addStylesheetRules(t,e){var i;if(this.document&&t&&0!==t.length){if(i=this._getStylesheetNode(e).sheet,"[object Array]"===Object.prototype.toString.call(t))for(var s=0,n=t.length;s<n;s++){var o=1,r=t[s],h=t[s][0],a="";"[object Array]"===Object.prototype.toString.call(r[1][0])&&(r=r[1],o=0);for(var d=r.length;o<d;o++){var c=r[o];a+=c[0]+":"+c[1]+(c[2]?" !important":"")+";\n";}i.insertRule(h+"{"+a+"}",i.cssRules.length);}else Object.keys(t).forEach(e=>{let s=t[e];if(Array.isArray(s))s.forEach(t=>{let s=Object.keys(t).map(e=>`${e}:${t[e]}`).join(";");i.insertRule(`${e}{${s}}`,i.cssRules.length);});else{let t=Object.keys(s).map(t=>`${t}:${s[t]}`).join(";");i.insertRule(`${e}{${t}}`,i.cssRules.length);}});}}addScript(t){return new Promise((function(e,i){var s,n=!1;if(!this.document){e(!1);return;}(s=this.document.createElement("script")).type="text/javascript",s.async=!0,s.src=t,s.onload=s.onreadystatechange=function(){n||this.readyState&&"complete"!=this.readyState||(n=!0,setTimeout(function(){e(!0);},1));},this.document.head.appendChild(s);}).bind(this));}addClass(t){var e;this.document&&(e=this.content||this.document.body)&&e.classList.add(t);}removeClass(t){var e;this.document&&(e=this.content||this.document.body)&&e.classList.remove(t);}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),d.DOM_EVENTS.forEach(function(t){this.document.addEventListener(t,this._triggerEvent,{passive:!0});},this));}removeEventListeners(){this.document&&(d.DOM_EVENTS.forEach(function(t){this.document.removeEventListener(t,this._triggerEvent,{passive:!0});},this),this._triggerEvent=void 0);}triggerEvent(t){this.emit(t.type,t);}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}));}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0);}onSelectionChange(t){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var t=this.window.getSelection();this.triggerSelectedEvent(t);}).bind(this),250);}triggerSelectedEvent(e){var i,s;e&&e.rangeCount>0&&!(i=e.getRangeAt(0)).collapsed&&(s=new(t.f(r))(i,this.cfiBase).toString(),this.emit(d.EVENTS.CONTENTS.SELECTED,s),this.emit(d.EVENTS.CONTENTS.SELECTED_RANGE,i));}range(e,i){return new(t.f(r))(e).toRange(this.document,i);}cfiFromRange(e,i){return new(t.f(r))(e,this.cfiBase,i).toString();}cfiFromNode(e,i){return new(t.f(r))(e,this.cfiBase,i).toString();}map(e){return new(t.f(h))(e).section();}size(t,e){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling"),t>=0&&(this.width(t),i.width=t,this.css("padding","0 "+t/12+"px")),e>=0&&(this.height(e),i.height=e),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(i);}columns(t,e,i,s,n){let r=o.prefixed("column-axis"),h=o.prefixed("column-gap"),a=o.prefixed("column-width"),d=o.prefixed("column-fill"),c=0===this.writingMode().indexOf("vertical")?"vertical":"horizontal";this.layoutStyle("paginated"),"rtl"===n&&"horizontal"===c&&this.direction(n),this.width(t),this.height(e),this.viewport({width:t,height:e,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),"vertical"===c?(this.css("padding-top",s/2+"px",!0),this.css("padding-bottom",s/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(r,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",s/2+"px",!0),this.css("padding-right",s/2+"px",!0),this.css(r,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(d,"auto"),this.css(h,s+"px"),this.css(a,i+"px"),this.css("-webkit-line-box-contain","block glyphs replaced");}scaler(t,e,i){var s="";this.css("transform-origin","top left"),(e>=0||i>=0)&&(s=" translate("+(e||0)+"px, "+(i||0)+"px )"),this.css("transform","scale("+t+")"+s);}fit(t,e,i){var s=this.viewport(),n=parseInt(s.width),o=parseInt(s.height),r=t/n,h=e/o,a=r<h?r:h;if(this.layoutStyle("paginated"),this.width(n),this.height(o),this.overflow("hidden"),this.scaler(a,0,0),this.css("background-size",n*a+"px "+o*a+"px"),this.css("background-color","transparent"),i&&i.properties.includes("page-spread-left")){var d=t-n*a;this.css("margin-left",d+"px");}}direction(t){this.documentElement&&(this.documentElement.style.direction=t);}mapPage(e,i,s,n,o){return new(t.f(h))(i,o).page(this,e,s,n);}linksHandler(){a.replaceLinks(this.content,t=>{this.emit(d.EVENTS.CONTENTS.LINK_CLICKED,t);});}writingMode(t){let e=o.prefixed("writing-mode");return t&&this.documentElement&&(this.documentElement.style[e]=t),this.window.getComputedStyle(this.documentElement)[e]||"";}layoutStyle(t){return t&&(this._layoutStyle=t,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated";}epubReadingSystem(t,e){return navigator.epubReadingSystem={name:t,version:e,layoutStyle:this.layoutStyle(),hasFeature:function(t){switch(t){case"dom-manipulation":case"layout-changes":case"touch-events":case"mouse-events":case"keyboard-events":return!0;default:return!1;}}},navigator.epubReadingSystem;}destroy(){this.removeListeners();}}t.f(n)(m.prototype),e.default=m;},"a043b48d":function e(e,E,d,D){e._m(E),e.o(E,"EPUBJS_VERSION",()=>A),e.o(E,"DOM_EVENTS",()=>o),e.o(E,"EVENTS",()=>R);var A="0.3",o=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],R={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};},"aa06c467":function t(t,e,i,r){t._m(e);var a=i("ef158879");e.default=class{constructor(t){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},t&&this.parse(t);}parse(t){var e,i,r;if(!t)throw Error("Package File Not Found");if(!(e=a.qs(t,"metadata")))throw Error("No Metadata Found");if(!(i=a.qs(t,"manifest")))throw Error("No Manifest Found");if(!(r=a.qs(t,"spine")))throw Error("No Spine Found");return this.manifest=this.parseManifest(i),this.navPath=this.findNavPath(i),this.ncxPath=this.findNcxPath(i,r),this.coverPath=this.findCoverPath(t),this.spineNodeIndex=a.indexOfElementNode(r),this.spine=this.parseSpine(r,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(t),this.metadata=this.parseMetadata(e),this.metadata.direction=r.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex};}parseMetadata(t){var e={};return e.title=this.getElementText(t,"title"),e.creator=this.getElementText(t,"creator"),e.description=this.getElementText(t,"description"),e.pubdate=this.getElementText(t,"date"),e.publisher=this.getElementText(t,"publisher"),e.identifier=this.getElementText(t,"identifier"),e.language=this.getElementText(t,"language"),e.rights=this.getElementText(t,"rights"),e.modified_date=this.getPropertyText(t,"dcterms:modified"),e.layout=this.getPropertyText(t,"rendition:layout"),e.orientation=this.getPropertyText(t,"rendition:orientation"),e.flow=this.getPropertyText(t,"rendition:flow"),e.viewport=this.getPropertyText(t,"rendition:viewport"),e.media_active_class=this.getPropertyText(t,"media:active-class"),e.spread=this.getPropertyText(t,"rendition:spread"),e;}parseManifest(t){var e={},i=a.qsa(t,"item");return Array.prototype.slice.call(i).forEach(function(t){var i=t.getAttribute("id"),r=t.getAttribute("href")||"",a=t.getAttribute("media-type")||"",n=t.getAttribute("media-overlay")||"",s=t.getAttribute("properties")||"";e[i]={href:r,type:a,overlay:n,properties:s.length?s.split(" "):[]};}),e;}parseSpine(t,e){var i=[],r=a.qsa(t,"itemref");return Array.prototype.slice.call(r).forEach(function(t,e){var r=t.getAttribute("idref"),a=t.getAttribute("properties")||"",n=a.length?a.split(" "):[],s={id:t.getAttribute("id"),idref:r,linear:t.getAttribute("linear")||"yes",properties:n,index:e};i.push(s);}),i;}findUniqueIdentifier(t){var e=t.documentElement.getAttribute("unique-identifier");if(!e)return"";var i=t.getElementById(e);return i&&"identifier"===i.localName&&"http://purl.org/dc/elements/1.1/"===i.namespaceURI&&i.childNodes.length>0?i.childNodes[0].nodeValue.trim():"";}findNavPath(t){var e=a.qsp(t,"item",{properties:"nav"});return!!e&&e.getAttribute("href");}findNcxPath(t,e){var i,r=a.qsp(t,"item",{"media-type":"application/x-dtbncx+xml"});return!r&&(i=e.getAttribute("toc"))&&(r=t.querySelector(`#${i}`)),!!r&&r.getAttribute("href");}findCoverPath(t){a.qs(t,"package").getAttribute("version");var e=a.qsp(t,"item",{properties:"cover-image"});if(e)return e.getAttribute("href");var i=a.qsp(t,"meta",{name:"cover"});if(!i)return!1;var r=i.getAttribute("content"),n=t.getElementById(r);return n?n.getAttribute("href"):"";}getElementText(t,e){var i,r=t.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",e);return r&&0!==r.length&&(i=r[0]).childNodes.length?i.childNodes[0].nodeValue:"";}getPropertyText(t,e){var i=a.qsp(t,"meta",{property:e});return i&&i.childNodes.length?i.childNodes[0].nodeValue:"";}load(t){this.metadata=t.metadata;let e=t.readingOrder||t.spine;return this.spine=e.map((t,e)=>(t.index=e,t.linear=t.linear||"yes",t)),t.resources.forEach((t,e)=>{this.manifest[e]=t,t.rel&&"cover"===t.rel[0]&&(this.coverPath=t.href);}),this.spineNodeIndex=0,this.toc=t.toc.map((t,e)=>(t.label=t.title,t)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc};}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0;}};},"ab536744":function t(t,e,i,s){t._m(e);var n=i("ef158879"),r=t.i(i("77c5c406")),o=t.i(i("bf80adb5")),h=i("a043b48d"),a=t.i(i("fc84397d"));class c{constructor(e,i,s){this.spine=e,this.request=i,this.pause=s||100,this.q=new(t.f(r))(this),this.epubcfi=new(t.f(o)),this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0;}generate(t){return t&&(this.break=t),this.q.pause(),this.spine.each((function(t){t.linear&&this.q.enqueue(this.process.bind(this),t);}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations;}).bind(this));}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0};}process(t){return t.load(this.request).then((function(e){var i=new n.defer,s=this.parse(e,t.cfiBase);return this._locations=this._locations.concat(s),t.unload(),this.processingTimeout=setTimeout(()=>i.resolve(s),this.pause),i.promise;}).bind(this));}parse(e,i,s){var r,h,a=[],c=e.ownerDocument,u=n.qs(c,"body"),l=0,f=s||this.break;if(n.sprint(u,(function(e){var s,n=e.length,c=0;if(0===e.textContent.trim().length)return!1;for(0==l&&((r=this.createRange()).startContainer=e,r.startOffset=0),(s=f-l)>n&&(l+=n,c=n);c<n;)if(s=f-l,0===l&&(c+=1,(r=this.createRange()).startContainer=e,r.startOffset=c),c+s>=n)l+=n-c,c=n;else{c+=s,r.endContainer=e,r.endOffset=c;let n=new(t.f(o))(r,i).toString();a.push(n),l=0;}h=e;}).bind(this)),r&&r.startContainer&&h){r.endContainer=h,r.endOffset=h.length;let e=new(t.f(o))(r,i).toString();a.push(e),l=0;}return a;}generateFromWords(e,i,s){var n=e?new(t.f(o))(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(t){t.linear&&(n?t.index>=n.spinePos&&this.q.enqueue(this.processWords.bind(this),t,i,n,s):this.q.enqueue(this.processWords.bind(this),t,i,n,s));}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords;}).bind(this));}processWords(t,e,i,s){return s&&this._locationsWords.length>=s?Promise.resolve():t.load(this.request).then((function(r){var o=new n.defer,h=this.parseWords(r,t,e,i),a=s-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(h.length>=s?h.slice(0,a):h),t.unload(),this.processingTimeout=setTimeout(()=>o.resolve(h),this.pause),o.promise;}).bind(this));}countWords(t){return(t=(t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[ ]{2,}/gi," ")).replace(/\n /,"\n")).split(" ").length;}parseWords(e,i,s,r){var h,a=i.cfiBase,c=[],u=e.ownerDocument,l=n.qs(u,"body"),f=!r||r.spinePos!==i.index;return r&&i.index===r.spinePos&&(h=r.findNode(r.range?r.path.steps.concat(r.start.steps):r.path.steps,e.ownerDocument)),n.sprint(l,(function(e){if(!f){if(e!==h)return!1;f=!0;}if(e.textContent.length<10&&0===e.textContent.trim().length)return!1;var i,n=this.countWords(e.textContent),r=0;if(0===n)return!1;for((i=s-this._wordCounter)>n&&(this._wordCounter+=n,r=n);r<n;)if(r+(i=s-this._wordCounter)>=n)this._wordCounter+=n-r,r=n;else{r+=i;let s=new(t.f(o))(e,a);c.push({cfi:s.toString(),wordCount:this._wordCounter}),this._wordCounter=0;}}).bind(this)),c;}locationFromCfi(e){let i;return(t.f(o).prototype.isCfiString(e)&&(e=new(t.f(o))(e)),0===this._locations.length)?-1:(i=n.locationOf(e,this._locations,this.epubcfi.compare))>this.total?this.total:i;}percentageFromCfi(t){if(0===this._locations.length)return null;var e=this.locationFromCfi(t);return this.percentageFromLocation(e);}percentageFromLocation(t){return t&&this.total?t/this.total:0;}cfiFromLocation(t){var e=-1;return"number"!=typeof t&&(t=parseInt(t)),t>=0&&t<this._locations.length&&(e=this._locations[t]),e;}cfiFromPercentage(e){let i;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let e=new(t.f(o))(this._locations[this.total]);return e.collapse(),e.toString();}return i=Math.ceil(this.total*e),this.cfiFromLocation(i);}load(t){return"string"==typeof t?this._locations=JSON.parse(t):this._locations=t,this.total=this._locations.length-1,this._locations;}save(){return JSON.stringify(this._locations);}getCurrent(){return this._current;}setCurrent(t){var e;if("string"==typeof t)this._currentCfi=t;else{if("number"!=typeof t)return;this._current=t;}0!==this._locations.length&&("string"==typeof t?(e=this.locationFromCfi(t),this._current=e):e=t,this.emit(h.EVENTS.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(e)}));}get currentLocation(){return this._current;}set currentLocation(t){this.setCurrent(t);}length(){return this._locations.length;}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout);}}t.f(a)(c.prototype),e.default=c;},"bf80adb5":function t(t,e,s,n){t._m(e);var i=s("ef158879");class r{constructor(t,e,s){var n;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof r))return new r(t,e,s);if("string"==typeof e?this.base=this.parseComponent(e):"object"==typeof e&&e.steps&&(this.base=e),"string"===(n=this.checkType(t)))return this.str=t,i.extend(this,this.parse(t));if("range"===n)return i.extend(this,this.fromRange(t,this.base,s));if("node"===n)return i.extend(this,this.fromNode(t,this.base,s));if("EpubCFI"===n&&t.path)return t;else if(!t)return this;else throw TypeError("not a valid argument for EpubCFI");}checkType(t){return this.isCfiString(t)?"string":t&&"object"==typeof t&&("Range"===i.type(t)||void 0!==t.startContainer)?"range":t&&"object"==typeof t&&void 0!==t.nodeType?"node":!!t&&"object"==typeof t&&t instanceof r&&"EpubCFI";}parse(t){var e,s,n,i={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return"string"!=typeof t?{spinePos:-1}:(0===t.indexOf("epubcfi(")&&")"===t[t.length-1]&&(t=t.slice(8,t.length-1)),e=this.getChapterComponent(t))?(i.base=this.parseComponent(e),s=this.getPathComponent(t),i.path=this.parseComponent(s),(n=this.getRange(t))&&(i.range=!0,i.start=this.parseComponent(n[0]),i.end=this.parseComponent(n[1])),i.spinePos=i.base.steps[1].index,i):{spinePos:-1};}parseComponent(t){var e,s={steps:[],terminal:{offset:null,assertion:null}},n=t.split(":"),i=n[0].split("/");return n.length>1&&(e=n[1],s.terminal=this.parseTerminal(e)),""===i[0]&&i.shift(),s.steps=i.map((function(t){return this.parseStep(t);}).bind(this)),s;}parseStep(t){var e,s,n,i,r;if((i=t.match(/\[(.*)\]/))&&i[1]&&(r=i[1]),!isNaN(s=parseInt(t)))return s%2==0?(e="element",n=s/2-1):(e="text",n=(s-1)/2),{type:e,index:n,id:r||null};}parseTerminal(t){var e,s,n=t.match(/\[(.*)\]/);return n&&n[1]?(e=parseInt(t.split("[")[0]),s=n[1]):e=parseInt(t),i.isNumber(e)||(e=null),{offset:e,assertion:s};}getChapterComponent(t){return t.split("!")[0];}getPathComponent(t){var e=t.split("!");if(e[1])return e[1].split(",")[0];}getRange(t){var e=t.split(",");return 3===e.length&&[e[1],e[2]];}getCharecterOffsetComponent(t){return t.split(":")[1]||"";}joinSteps(t){return t?t.map(function(t){var e="";return"element"===t.type&&(e+=(t.index+1)*2),"text"===t.type&&(e+=1+2*t.index),t.id&&(e+="["+t.id+"]"),e;}).join("/"):"";}segmentString(t){var e="/";return e+=this.joinSteps(t.steps),t.terminal&&null!=t.terminal.offset&&(e+=":"+t.terminal.offset),t.terminal&&null!=t.terminal.assertion&&(e+="["+t.terminal.assertion+"]"),e;}toString(){var t="epubcfi(";return t+=this.segmentString(this.base)+"!"+this.segmentString(this.path),this.range&&this.start&&(t+=","+this.segmentString(this.start)),this.range&&this.end&&(t+=","+this.segmentString(this.end)),t+=")";}compare(t,e){if("string"==typeof t&&(t=new r(t)),"string"==typeof e&&(e=new r(e)),t.spinePos>e.spinePos)return 1;if(t.spinePos<e.spinePos)return -1;t.range?(s=t.path.steps.concat(t.start.steps),i=t.start.terminal):(s=t.path.steps,i=t.path.terminal),e.range?(n=e.path.steps.concat(e.start.steps),a=e.start.terminal):(n=e.path.steps,a=e.path.terminal);for(var s,n,i,a,o=0;o<s.length;o++){if(!s[o])return -1;if(!n[o]||s[o].index>n[o].index)return 1;if(s[o].index<n[o].index)return -1;}return s.length<n.length?-1:i.offset>a.offset?1:i.offset<a.offset?-1:0;}step(t){var e=3===t.nodeType?"text":"element";return{id:t.id,tagName:t.tagName,type:e,index:this.position(t)};}filteredStep(t,e){var s,n=this.filter(t,e);if(n)return s=3===n.nodeType?"text":"element",{id:n.id,tagName:n.tagName,type:s,index:this.filteredPosition(n,e)};}pathTo(t,e,s){for(var n,i={steps:[],terminal:{offset:null,assertion:null}},r=t;r&&r.parentNode&&9!=r.parentNode.nodeType;)(n=s?this.filteredStep(r,s):this.step(r))&&i.steps.unshift(n),r=r.parentNode;return null!=e&&e>=0&&(i.terminal.offset=e,"text"!=i.steps[i.steps.length-1].type&&i.steps.push({type:"text",index:0})),i;}equalStep(t,e){return!!t&&!!e&&t.index===e.index&&t.id===e.id&&t.type===e.type;}fromRange(t,e,s){var n={range:!1,base:{},path:{},start:null,end:null},i=t.startContainer,r=t.endContainer,a=t.startOffset,o=t.endOffset,p=!1;if(s&&(p=null!=i.ownerDocument.querySelector("."+s)),"string"==typeof e?(n.base=this.parseComponent(e),n.spinePos=n.base.steps[1].index):"object"==typeof e&&(n.base=e),t.collapsed)p&&(a=this.patchOffset(i,a,s)),n.path=this.pathTo(i,a,s);else{n.range=!0,p&&(a=this.patchOffset(i,a,s)),n.start=this.pathTo(i,a,s),p&&(o=this.patchOffset(r,o,s)),n.end=this.pathTo(r,o,s),n.path={steps:[],terminal:null};var l,h=n.start.steps.length;for(l=0;l<h;l++)if(this.equalStep(n.start.steps[l],n.end.steps[l]))l===h-1?n.start.terminal===n.end.terminal&&(n.path.steps.push(n.start.steps[l]),n.range=!1):n.path.steps.push(n.start.steps[l]);else break;n.start.steps=n.start.steps.slice(n.path.steps.length),n.end.steps=n.end.steps.slice(n.path.steps.length);}return n;}fromNode(t,e,s){var n={range:!1,base:{},path:{},start:null,end:null};return"string"==typeof e?(n.base=this.parseComponent(e),n.spinePos=n.base.steps[1].index):"object"==typeof e&&(n.base=e),n.path=this.pathTo(t,null,s),n;}filter(t,e){var s,n,i,r,a,o=!1;return(3===t.nodeType?(o=!0,i=t.parentNode,s=t.parentNode.classList.contains(e)):(o=!1,s=t.classList.contains(e)),s&&o)?(r=i.previousSibling,a=i.nextSibling,r&&3===r.nodeType?n=r:a&&3===a.nodeType&&(n=a),n)?n:t:(!s||!!o)&&t;}patchOffset(t,e,s){if(3!=t.nodeType)throw Error("Anchor must be a text node");var n=t,i=e;for(t.parentNode.classList.contains(s)&&(n=t.parentNode);n.previousSibling;){if(1===n.previousSibling.nodeType){if(n.previousSibling.classList.contains(s))i+=n.previousSibling.textContent.length;else break;}else i+=n.previousSibling.textContent.length;n=n.previousSibling;}return i;}normalizedMap(t,e,s){var n,i,r,a={},o=-1,p=t.length;for(r=0;r<p;r++)1===(n=t[r].nodeType)&&t[r].classList.contains(s)&&(n=3),r>0&&3===n&&3===i?a[r]=o:e===n&&(o+=1,a[r]=o),i=n;return a;}position(t){var e,s;return 1===t.nodeType?((e=t.parentNode.children)||(e=i.findChildren(t.parentNode)),s=Array.prototype.indexOf.call(e,t)):s=(e=this.textNodes(t.parentNode)).indexOf(t),s;}filteredPosition(t,e){var s,n;return 1===t.nodeType?(s=t.parentNode.children,n=this.normalizedMap(s,1,e)):(s=t.parentNode.childNodes,t.parentNode.classList.contains(e)&&(s=(t=t.parentNode).parentNode.childNodes),n=this.normalizedMap(s,3,e)),n[Array.prototype.indexOf.call(s,t)];}stepsToXpath(t){var e=[".","*"];return t.forEach(function(t){var s=t.index+1;t.id?e.push("*[position()="+s+" and @id='"+t.id+"']"):"text"===t.type?e.push("text()["+s+"]"):e.push("*["+s+"]");}),e.join("/");}stepsToQuerySelector(t){var e=["html"];return t.forEach(function(t){var s=t.index+1;t.id?e.push("#"+t.id):"text"===t.type||e.push("*:nth-child("+s+")");}),e.join(">");}textNodes(t,e){return Array.prototype.slice.call(t.childNodes).filter(function(t){return 3===t.nodeType||!!(e&&t.classList.contains(e));});}walkToNode(t,e,s){var n,r,a=e||document,o=a.documentElement,p=t.length;for(r=0;r<p&&("element"===(n=t[r]).type?o=n.id?a.getElementById(n.id):(o.children||i.findChildren(o))[n.index]:"text"===n.type&&(o=this.textNodes(o,s)[n.index]),o);r++);return o;}findNode(t,e,s){var n,i,r=e||document;return s||void 0===r.evaluate?n=s?this.walkToNode(t,r,s):this.walkToNode(t,r):(i=this.stepsToXpath(t),n=r.evaluate(i,r,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),n;}fixMiss(t,e,s,n){var i,r,a=this.findNode(t.slice(0,-1),s,n),o=a.childNodes,p=this.normalizedMap(o,3,n),l=t[t.length-1].index;for(let t in p){if(!p.hasOwnProperty(t))return;if(p[t]===l){if(r=(i=o[t]).textContent.length,e>r)e-=r;else{a=1===i.nodeType?i.childNodes[0]:i;break;}}}return{container:a,offset:e};}toRange(t,e){var s,n,r,a,o,p,l,h,d=t||document,f=!!e&&null!=d.querySelector("."+e);if(s=void 0!==d.createRange?d.createRange():new i.RangeObject,this.range?(n=this.start,p=this.path.steps.concat(n.steps),a=this.findNode(p,d,f?e:null),r=this.end,l=this.path.steps.concat(r.steps),o=this.findNode(l,d,f?e:null)):(n=this.path,p=this.path.steps,a=this.findNode(this.path.steps,d,f?e:null)),!a)return console.log("No startContainer found for",this.toString()),null;try{null!=n.terminal.offset?s.setStart(a,n.terminal.offset):s.setStart(a,0);}catch(t){h=this.fixMiss(p,n.terminal.offset,d,f?e:null),s.setStart(h.container,h.offset);}if(o)try{null!=r.terminal.offset?s.setEnd(o,r.terminal.offset):s.setEnd(o,0);}catch(t){h=this.fixMiss(l,this.end.terminal.offset,d,f?e:null),s.setEnd(h.container,h.offset);}return s;}isCfiString(t){return"string"==typeof t&&0===t.indexOf("epubcfi(")&&")"===t[t.length-1];}generateChapterComponent(t,e,s){var n=parseInt(e),i="/"+(t+1)*2+"/";return i+=(n+1)*2,s&&(i+="["+s+"]"),i;}collapse(t){this.range&&(this.range=!1,t?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal));}}e.default=r;},"c48282c2":function e(e,t,s,r){e._m(t);var n=s("ef158879"),i=e.i(s("d9d2ff27")),o=e.i(s("0f707ffe")),a=e.i(s("f85cdffd")),h=e.i(s("fc84397d")),l=e.i(s("b1abea6a"));class d{constructor(t,s,r){this.urlCache={},this.storage=void 0,this.name=t,this.requester=s||e.f(i),this.resolver=r,this.online=!0,this.checkRequirements(),this.addListeners();}checkRequirements(){try{let t;void 0===e.f(l)&&(t=e.f(l)),this.storage=t.createInstance({name:this.name});}catch(e){throw Error("localForage lib not loaded");}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status);}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0;}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this);}add(e,t){return Promise.all(e.resources.map(e=>{let{href:s}=e,r=this.resolver(s),n=window.encodeURIComponent(r);return this.storage.getItem(n).then(e=>!e||t?this.requester(r,"binary").then(e=>this.storage.setItem(n,e)):e);}));}put(e,t,s){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(n=>n||this.requester(e,"binary",t,s).then(e=>this.storage.setItem(r,e)));}request(e,t,s,r){return this.online?this.requester(e,t,s,r).then(t=>(this.put(e),t)):this.retrieve(e,t);}retrieve(t,s){new n.defer;var r=new(e.f(a))(t);return s||(s=r.extension),("blob"==s?this.getBlob(t):this.getText(t)).then(e=>{var r,i=new n.defer;return e?(r=this.handleResponse(e,s),i.resolve(r)):i.reject({message:"File not found in storage: "+t,stack:Error().stack}),i.promise;});}handleResponse(e,t){return"json"==t?JSON.parse(e):n.isXml(t)?n.parse(e,"text/xml"):"xhtml"==t?n.parse(e,"application/xhtml+xml"):"html"==t||"htm"==t?n.parse(e,"text/html"):e;}getBlob(t,s){let r=window.encodeURIComponent(t);return this.storage.getItem(r).then(function(r){if(r)return new Blob([r],{type:s=s||e.f(o).lookup(t)});});}getText(t,s){let r=window.encodeURIComponent(t);return s=s||e.f(o).lookup(t),this.storage.getItem(r).then(function(e){var t,r=new n.defer,i=new FileReader;if(e)return t=new Blob([e],{type:s}),i.addEventListener("loadend",()=>{r.resolve(i.result);}),i.readAsText(t,s),r.promise;});}getBase64(t,s){let r=window.encodeURIComponent(t);return s=s||e.f(o).lookup(t),this.storage.getItem(r).then(e=>{var t,r=new n.defer,i=new FileReader;if(e)return t=new Blob([e],{type:s}),i.addEventListener("loadend",()=>{r.resolve(i.result);}),i.readAsDataURL(t,s),r.promise;});}createUrl(e,t){var s,r,i=new n.defer,o=window.URL||window.webkitURL||window.mozURL,a=t&&t.base64;return e in this.urlCache?i.resolve(this.urlCache[e]):(a?(r=this.getBase64(e))&&r.then((function(t){this.urlCache[e]=t,i.resolve(t);}).bind(this)):(r=this.getBlob(e))&&r.then((function(t){s=o.createObjectURL(t),this.urlCache[e]=s,i.resolve(s);}).bind(this)),r||i.reject({message:"File not found in storage: "+e,stack:Error().stack})),i.promise;}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,s=this.urlCache[e];s&&t.revokeObjectURL(s);}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners();}}e.f(h)(d.prototype),t.default=d;},"ce74a605":function e(e,t,n,i){e._m(t),e.o(t,"replaceBase",()=>c),e.o(t,"replaceCanonical",()=>o),e.o(t,"replaceMeta",()=>l),e.o(t,"replaceLinks",()=>f),e.o(t,"substitute",()=>s);var r=n("ef158879"),a=e.i(n("7fa13d64"));function c(e,t){var n,i,a=t.url,c=a.indexOf("://")>-1;e&&(i=r.qs(e,"head"),(n=r.qs(i,"base"))||(n=e.createElement("base"),i.insertBefore(n,i.firstChild)),!c&&window&&window.location&&(a=window.location.origin+a),n.setAttribute("href",a));}function o(e,t){var n,i,a=t.canonical;e&&(n=r.qs(e,"head"),(i=r.qs(n,"link[rel='canonical']"))?i.setAttribute("href",a):((i=e.createElement("link")).setAttribute("rel","canonical"),i.setAttribute("href",a),n.appendChild(i)));}function l(e,t){var n,i,a=t.idref;e&&(n=r.qs(e,"head"),(i=r.qs(n,"link[property='dc.identifier']"))?i.setAttribute("content",a):((i=e.createElement("meta")).setAttribute("name","dc.identifier"),i.setAttribute("content",a),n.appendChild(i)));}function f(t,n){var i=t.querySelectorAll("a[href]");if(i.length)for(var c=r.qs(t.ownerDocument,"base"),o=c?c.getAttribute("href"):void 0,l=(function(t){var i,r=t.getAttribute("href");if(0!==r.indexOf("mailto:")){if(r.indexOf("://")>-1)t.setAttribute("target","_blank");else{try{i=new(e.f(a))(r,o);}catch(e){}t.onclick=function(){return i&&i.hash?n(i.Path.path+i.hash):i?n(i.Path.path):n(r),!1;};}}}).bind(this),f=0;f<i.length;f++)l(i[f]);}function s(e,t,n){return t.forEach(function(t,i){t&&n[i]&&(t=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),e=e.replace(RegExp(t,"g"),n[i]));}),e;}},"d69de0d3":function e(e,f,n,a){e._m(f);var i=e.i(n("19a8aec4")),o=e.i(n("2a020ec6")),t=e.i(n("bf80adb5")),d=e.i(n("8fb0147d")),E=e.w(n("ef158879")),S=n("a043b48d");function b(f,n){return new(e.f(i))(f,n);}n("3ee48e39"),n("5a6d0fc7"),b.VERSION=S.EPUBJS_VERSION,"undefined"!=typeof global&&(global.EPUBJS_VERSION=S.EPUBJS_VERSION),b.Book=e.f(i),b.Rendition=e.f(o),b.Contents=e.f(d),b.CFI=e.f(t),b.utils=E,f.default=b;},"d9d2ff27":function e(e,s,t,r){e._m(s);var n=t("ef158879"),i=e.i(t("f85cdffd"));s.default=function(s,t,r,o){var p,a="undefined"!=typeof window&&window.URL,h=new n.defer,u=new XMLHttpRequest,f=XMLHttpRequest.prototype;for(p in"overrideMimeType"in f||Object.defineProperty(f,"overrideMimeType",{value:function(){}}),r&&(u.withCredentials=!0),u.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var e,s=!1;if((""===this.responseType||"document"===this.responseType)&&(s=this.responseXML),200===this.status||0===this.status||s){if(!this.response&&!s)return h.reject({status:this.status,message:"Empty Response",stack:Error().stack}),h.promise;if(403===this.status)return h.reject({status:this.status,response:this.response,message:"Forbidden",stack:Error().stack}),h.promise;e=s?this.responseXML:n.isXml(t)?n.parse(this.response,"text/xml"):"xhtml"==t?n.parse(this.response,"application/xhtml+xml"):"html"==t||"htm"==t?n.parse(this.response,"text/html"):"json"==t?JSON.parse(this.response):"blob"==t?a?this.response:new Blob([this.response]):this.response,h.resolve(e);}else h.reject({status:this.status,message:this.response,stack:Error().stack});}},u.onerror=function(e){h.reject(e);},u.open("GET",s,!0),o)u.setRequestHeader(p,o[p]);return"json"==t&&u.setRequestHeader("Accept","application/json"),t||(t=new(e.f(i))(s).extension),"blob"==t&&(u.responseType=a?"blob":"arraybuffer"),n.isXml(t)&&u.overrideMimeType("text/xml"),"binary"==t&&(u.responseType="arraybuffer"),u.send(),h.promise;};},"dc23aa53":function e(e,t,l,n){function d(){var e="reverse",t=i();return document.body.appendChild(t),t.scrollLeft>0?e="default":"undefined"!=typeof Element&&Element.prototype.scrollIntoView?(t.children[0].children[1].scrollIntoView(),t.scrollLeft<0&&(e="negative")):(t.scrollLeft=1,0===t.scrollLeft&&(e="negative")),document.body.removeChild(t),e;}function i(){var e=document.createElement("div");e.dir="rtl",e.style.position="fixed",e.style.width="1px",e.style.height="1px",e.style.top="0px",e.style.left="0px",e.style.overflow="hidden";var t=document.createElement("div");t.style.width="2px";var l=document.createElement("span");l.style.width="1px",l.style.display="inline-block";var n=document.createElement("span");return n.style.width="1px",n.style.display="inline-block",t.appendChild(l),t.appendChild(n),e.appendChild(t),e;}e._m(t),e.o(t,"default",()=>d),e.o(t,"createDefiner",()=>i);},"ef158879":function e(e,t,n,o){e._m(t),e.o(t,"requestAnimationFrame",()=>i),e.o(t,"uuid",()=>d),e.o(t,"documentHeight",()=>s),e.o(t,"isElement",()=>c),e.o(t,"isNumber",()=>f),e.o(t,"isFloat",()=>u),e.o(t,"prefixed",()=>l),e.o(t,"defaults",()=>h),e.o(t,"extend",()=>p),e.o(t,"insert",()=>m),e.o(t,"locationOf",()=>g),e.o(t,"indexOfSorted",()=>function e(t,n,o,r,i){var a,d=r||0,s=i||n.length,c=parseInt(d+(s-d)/2);return(o||(o=function(e,t){return e>t?1:e<t?-1:e==t?0:void 0;}),s-d<=0)?-1:(a=o(n[c],t),s-d==1)?0===a?c:-1:0===a?c:-1===a?e(t,n,o,c,s):e(t,n,o,d,c);}),e.o(t,"bounds",()=>w),e.o(t,"borders",()=>v),e.o(t,"nodeBounds",()=>y),e.o(t,"windowBounds",()=>x),e.o(t,"indexOfNode",()=>b),e.o(t,"indexOfTextNode",()=>C),e.o(t,"indexOfElementNode",()=>N),e.o(t,"isXml",()=>O),e.o(t,"createBlob",()=>T),e.o(t,"createBlobUrl",()=>E),e.o(t,"revokeBlobUrl",()=>R),e.o(t,"createBase64Url",()=>S),e.o(t,"type",()=>A),e.o(t,"parse",()=>B),e.o(t,"qs",()=>q),e.o(t,"qsa",()=>L),e.o(t,"qsp",()=>F),e.o(t,"sprint",()=>k),e.o(t,"treeWalker",()=>W),e.o(t,"walk",()=>U),e.o(t,"blob2base64",()=>j),e.o(t,"defer",()=>P),e.o(t,"querySelectorByType",()=>D),e.o(t,"findChildren",()=>_),e.o(t,"parents",()=>H),e.o(t,"filterChildren",()=>M),e.o(t,"getParentByTagName",()=>z),e.o(t,"RangeObject",()=>X);var r=n("57789411"),i="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame);let a="undefined"!=typeof URL?URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.mozURL:void 0;function d(){var e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:7&n|8).toString(16);});}function s(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight);}function c(e){return!!(e&&1==e.nodeType);}function f(e){return!isNaN(parseFloat(e))&&isFinite(e);}function u(e){let t=parseFloat(e);return!1!==f(e)&&(!!("string"==typeof e&&e.indexOf(".")>-1)||Math.floor(t)!==t);}function l(e){var t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],n=e.toLowerCase();if("undefined"==typeof document||void 0!==document.body.style[n])return e;for(var o=0;o<5;o++)if(void 0!==document.body.style[t[o]+n])return t[o]+n;return e;}function h(e){for(var t=1,n=arguments.length;t<n;t++){var o=arguments[t];for(var r in o)void 0===e[r]&&(e[r]=o[r]);}return e;}function p(e){var t=[].slice.call(arguments,1);return t.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n));});}),e;}function m(e,t,n){var o=g(e,t,n);return t.splice(o,0,e),o;}function g(e,t,n,o,r){var i,a=o||0,d=r||t.length,s=parseInt(a+(d-a)/2);return(n||(n=function(e,t){return e>t?1:e<t?-1:e==t?0:void 0;}),d-a<=0)?s:(i=n(t[s],e),d-a==1)?i>=0?s:s+1:0===i?s:-1===i?g(e,t,n,s,d):g(e,t,n,a,s);}function w(e){var t=window.getComputedStyle(e),n=0,o=0;return["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach(function(e){n+=parseFloat(t[e])||0;}),["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach(function(e){o+=parseFloat(t[e])||0;}),{height:o,width:n};}function v(e){var t=window.getComputedStyle(e),n=0,o=0;return["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach(function(e){n+=parseFloat(t[e])||0;}),["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach(function(e){o+=parseFloat(t[e])||0;}),{height:o,width:n};}function y(e){let t;let n=e.ownerDocument;if(e.nodeType==Node.TEXT_NODE){let o=n.createRange();o.selectNodeContents(e),t=o.getBoundingClientRect();}else t=e.getBoundingClientRect();return t;}function x(){var e=window.innerWidth,t=window.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t};}function b(e,t){for(var n,o=e.parentNode.childNodes,r=-1,i=0;i<o.length&&((n=o[i]).nodeType===t&&r++,n!=e);i++);return r;}function C(e){return b(e,3);}function N(e){return b(e,1);}function O(e){return["xml","opf","ncx"].indexOf(e)>-1;}function T(e,t){return new Blob([e],{type:t});}function E(e,t){var n=T(e,t);return a.createObjectURL(n);}function R(e){return a.revokeObjectURL(e);}function S(e,t){if("string"==typeof e)return"data:"+t+";base64,"+btoa(e);}function A(e){return Object.prototype.toString.call(e).slice(8,-1);}function B(e,t,n){var o;return"undefined"==typeof DOMParser||n?o=r.DOMParser:o=DOMParser,65279===e.charCodeAt(0)&&(e=e.slice(1)),new o().parseFromString(e,t);}function q(e,t){var n;if(!e)throw Error("No Element Provided");return void 0!==e.querySelector?e.querySelector(t):(n=e.getElementsByTagName(t)).length?n[0]:void 0;}function L(e,t){return void 0!==e.querySelector?e.querySelectorAll(t):e.getElementsByTagName(t);}function F(e,t,n){var o,r;if(void 0!==e.querySelector){for(var i in t+="[",n)t+=i+"~='"+n[i]+"'";return t+="]",e.querySelector(t);}if(o=e.getElementsByTagName(t),r=Array.prototype.slice.call(o,0).filter(function(e){for(var t in n)if(e.getAttribute(t)===n[t])return!0;return!1;}))return r[0];}function k(e,t){void 0!==(e.ownerDocument||e).createTreeWalker?W(e,t,NodeFilter.SHOW_TEXT):U(e,function(e){e&&3===e.nodeType&&t(e);},!0);}function W(e,t,n){let o;for(var r=document.createTreeWalker(e,n,null,!1);o=r.nextNode();)t(o);}function U(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(U(e,t))return!0;e=e.nextSibling;}while(e)}function j(e){return new Promise(function(t,n){var o=new FileReader;o.readAsDataURL(e),o.onloadend=function(){t(o.result);};});}function P(){this.resolve=null,this.reject=null,this.id=d(),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t;}),Object.freeze(this);}function D(e,t,n){var o;if(void 0!==e.querySelector&&(o=e.querySelector(`${t}[*|type="${n}"]`)),o&&0!==o.length)return o;o=L(e,t);for(var r=0;r<o.length;r++)if(o[r].getAttributeNS("http://www.idpf.org/2007/ops","type")===n||o[r].getAttribute("epub:type")===n)return o[r];}function _(e){for(var t=[],n=e.childNodes,o=0;o<n.length;o++){let e=n[o];1===e.nodeType&&t.push(e);}return t;}function H(e){for(var t=[e];e;e=e.parentNode)t.unshift(e);return t;}function M(e,t,n){for(var o=[],r=e.childNodes,i=0;i<r.length;i++){let e=r[i];if(1===e.nodeType&&e.nodeName.toLowerCase()===t){if(n)return e;o.push(e);}}if(!n)return o;}function z(e,t){let n;if(null!==e&&""!==t)for(n=e.parentNode;1===n.nodeType;){if(n.tagName.toLowerCase()===t)return n;n=n.parentNode;}}class X{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0;}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed();}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed();}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode);}selectNode(e){let t=e.parentNode,n=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,n),this.setEnd(t,n+1);}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=3===e.nodeType?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t);}_commonAncestorContainer(e,t){var n=H(e||this.startContainer),o=H(t||this.endContainer);if(n[0]==o[0]){for(var r=0;r<n.length;r++)if(n[r]!=o[r])return n[r-1];}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1;}toString(){}}},"f85cdffd":function t(t,e,r,i){t._m(e);var s=t.i(r("789f8ab1"));e.default=class{constructor(t){var e;t.indexOf("://")>-1&&(t=new URL(t).pathname),e=this.parse(t),this.path=t,this.isDirectory(t)?this.directory=t:this.directory=e.dir+"/",this.filename=e.base,this.extension=e.ext.slice(1);}parse(e){return t.f(s).parse(e);}isAbsolute(e){return t.f(s).isAbsolute(e||this.path);}isDirectory(t){return"/"===t.charAt(t.length-1);}resolve(e){return t.f(s).resolve(this.directory,e);}relative(e){return e&&e.indexOf("://")>-1?e:t.f(s).relative(this.directory,e);}splitPath(t){return this.splitPathRe.exec(t).slice(1);}toString(){return this.path;}};},"f92b9fa9":function e(e,i,s,t){e._m(i);var n=e.i(s("bf80adb5")),h=e.i(s("f9cf22ea")),r=e.i(s("70a38bc9")),o=s("ce74a605");i.default=class{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new(e.f(h)),this.hooks.content=new(e.f(h)),this.hooks.content.register(o.replaceBase),this.hooks.content.register(o.replaceCanonical),this.hooks.content.register(o.replaceMeta),this.epubcfi=new(e.f(n)),this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0;}unpack(i,s,t){this.items=i.spine,this.manifest=i.manifest,this.spineNodeIndex=i.spineNodeIndex,this.baseUrl=i.baseUrl||i.basePath||"",this.length=this.items.length,this.items.forEach((i,n)=>{var h,o=this.manifest[i.idref];i.index=n,i.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,i.index,i.id),i.href&&(i.url=s(i.href,!0),i.canonical=t(i.href)),o&&(i.href=o.href,i.url=s(i.href,!0),i.canonical=t(i.href),o.properties.length&&i.properties.push.apply(i.properties,o.properties)),"yes"===i.linear?(i.prev=(function(){let e=i.index;for(;e>0;){let i=this.get(e-1);if(i&&i.linear)return i;e-=1;}}).bind(this),i.next=(function(){let e=i.index;for(;e<this.spineItems.length-1;){let i=this.get(e+1);if(i&&i.linear)return i;e+=1;}}).bind(this)):(i.prev=function(){},i.next=function(){}),h=new(e.f(r))(i,this.hooks),this.append(h);}),this.loaded=!0;}get(i){var s=0;if(void 0===i)for(;s<this.spineItems.length;){let e=this.spineItems[s];if(e&&e.linear)break;s+=1;}else this.epubcfi.isCfiString(i)?s=new(e.f(n))(i).spinePos:"number"==typeof i||!1===isNaN(i)?s=i:"string"==typeof i&&0===i.indexOf("#")?s=this.spineById[i.substring(1)]:"string"==typeof i&&(i=i.split("#")[0],s=this.spineByHref[i]||this.spineByHref[encodeURI(i)]);return this.spineItems[s]||null;}append(e){var i=this.spineItems.length;return e.index=i,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=i,this.spineByHref[encodeURI(e.href)]=i,this.spineByHref[e.href]=i,this.spineById[e.idref]=i,i;}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(e,i){e.index=i;}),0;}remove(e){var i=this.spineItems.indexOf(e);if(i>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(i,1);}each(){return this.spineItems.forEach.apply(this.spineItems,arguments);}first(){let e=0;do{let i=this.get(e);if(i&&i.linear)return i;e+=1;}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let i=this.get(e);if(i&&i.linear)return i;e-=1;}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0;}};},"f9cf22ea":function t(t,o,s,h){t._m(o),o.default=class{constructor(t){this.context=t||this,this.hooks=[];}register(){for(var t=0;t<arguments.length;++t)if("function"==typeof arguments[t])this.hooks.push(arguments[t]);else for(var o=0;o<arguments[t].length;++o)this.hooks.push(arguments[t][o]);}deregister(t){for(let o=0;o<this.hooks.length;o++)if(this.hooks[o]===t){this.hooks.splice(o,1);break;}}trigger(){var t=arguments,o=this.context,s=[];return this.hooks.forEach(function(h){try{var e=h.apply(o,t);}catch(t){console.log(t);}e&&"function"==typeof e.then&&s.push(e);}),Promise.all(s);}list(){return this.hooks;}clear(){return this.hooks=[];}};},});